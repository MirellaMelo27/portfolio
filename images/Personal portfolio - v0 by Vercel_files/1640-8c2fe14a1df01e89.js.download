(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1640],{171:(e,t,l)=>{"use strict";l.d(t,{$N:()=>x,Ik:()=>h,h5:()=>p,jY:()=>o,q_:()=>g,rD:()=>a,tD:()=>v});var n=l(71229),i=l(78931),s=l(72633);let a="v0-durable-state",r=s.z.enum(["collapsed","compact"]),o=["block","editor","chat"],c=s.z.enum(o),d=s.z.enum(["history","environment-variables","assets","knowledge","collapsed","integrations"]),u=s.z.object({id:c,ratio:s.z.number(),visible:s.z.boolean().default(!0),savedRatio:s.z.number().optional(),savedVisibility:s.z.boolean().optional()}),m=s.z.object({composerLayout:r,panelsLayout:s.z.array(u).refine(e=>{let t=e.map(e=>e.id),l=new Set(t),n=c.options;return l.size===t.length&&n.every(e=>t.includes(e))},"Panel layout must contain exactly one of each panel type (block, editor, chat)"),mobilePanel:c,sidebar:d,lastUpdated:s.z.number()}),f=s.z.record(s.z.string(),m),p={composerLayout:"collapsed",sidebar:"collapsed",lastUpdated:v(),...n.P["classic-v0"]};function h(e){try{if(!e)return null;let t=(0,i.decompressFromBase64)(e);if(!t)return null;let l=JSON.parse(t),n=f.safeParse(l);if(!n.success)throw Error("Invalid durable state",{cause:n.error});return n.data}catch(e){return console.warn("Error parsing durable state cookie:",e),null}}function x(e){return(0,i.compressToBase64)(JSON.stringify(e))}function v(){let e=new Date,t=e.getFullYear()%100,l=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0");return parseInt("".concat(t).concat(l).concat(n).concat(i).concat(s))}function g(e,t){return e-t}},945:(e,t,l)=>{"use strict";l.d(t,{sw:()=>o,tC:()=>m,yQ:()=>f});var n=l(27007),i=l(94585),s=l(7222),a=l(55074),r=l(75480);let o=10,c=new Map,d=(0,i.G)(c,()=>({editors:(0,n.eU)([]),contentHtml:(0,n.eU)(null),contentJson:(0,n.eU)(null),contentText:(0,n.eU)(null),context:(0,n.eU)([])})),u=new Map,m=(0,i.G)(u,e=>{let t=d(e),l=(0,a.jP)(e),i=(0,r.Nt)();return{...t,isAbleToSubmit:(0,n.eU)(e=>{let n=e(t.editors);if(!e(i.getRateLimit)||!n.length||!n.every(e=>e.isEditorReady)||e(l.isStreaming))return!1;let s=e(t.contentText);return!!s&&(null==s?void 0:s.trim())!==""}),areEditorsReady:(0,n.eU)(e=>e(t.editors).every(e=>e.isEditorReady)),contextLimitReached:(0,n.eU)(e=>e(t.context).length>=o),sortedContext:(0,n.eU)(e=>(function(e){let t=["refinement-element","attachment"];return e.sort((e,l)=>t.indexOf(e.type)-t.indexOf(l.type))})(e(t.context)))}});function f(e){let t=d(e),l=m(e),n=(e,l)=>{let n=s.M.get(t.editors);l&&(s.M.set(t.contentHtml,l.getHTML()),s.M.set(t.contentJson,l.getJSON()),s.M.set(t.contentText,l.getText()),n.forEach(t=>{let{id:n,editor:i}=t;n!==e&&i.commands.setContent(l.getHTML())}))};return{clearEditorContent:()=>{let l=s.M.get(t.editors);l.length&&l.forEach((t,l)=>{let{editor:i}=t;i.commands.clearContent(),0===l&&n(e,i)})},registerEditor:e=>s.M.set(t.editors,[...s.M.get(t.editors),e]),unregisterEditor:e=>s.M.set(t.editors,s.M.get(t.editors).filter(t=>t.id!==e)),updateContentStates:n,focusPrompt:()=>{requestAnimationFrame(()=>{let e=s.M.get(t.editors);if(!e.length)return console.warn("Cannot focus prompt: editor not initialized");e.forEach(e=>e.editor.commands.focus())})},addRefinementElementToContext:e=>{if(s.M.get(l.contextLimitReached))return;let n=s.M.get(t.context).filter(t=>"refinement-element"!==t.type||t.data.id!==e.id);s.M.set(t.context,[...n,{type:"refinement-element",data:e}])},clearRefinementElements:()=>{let e=s.M.get(t.context);s.M.set(t.context,e.filter(e=>"refinement-element"!==e.type))},addFileAttachmentsToContext:e=>{let l=s.M.get(t.context),n=o-l.length;if(n<=0)return;let i=e.slice(0,n);s.M.set(t.context,[...l,...i.map(e=>{let{file:t,upload:l}=e;return{type:"attachment",data:{file:t,name:t.name,type:t.type,size:t.size,upload:l}}})])},removeIndexFromContext:e=>{let l=s.M.get(t.context);s.M.set(t.context,l.filter((t,l)=>l!==e))},clearAttachments:()=>{let e=s.M.get(t.context);s.M.set(t.context,e.filter(e=>"attachment"!==e.type))}}}},4371:(e,t,l)=>{"use strict";l.d(t,{H:()=>i});var n=l(7336);function i(){return(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsxs)("g",{id:"Icon",children:[(0,n.jsx)("path",{fill:"currentcolor",fillRule:"evenodd",clipRule:"evenodd",d:"M13.7497 10.75L13.7497 11.5L13.7497 13.2494C13.7497 14.2159 12.9662 14.9994 11.9997 14.9994L2.75 14.9994C1.7835 14.9994 1 14.2159 1 13.2494L1 4C1 3.0335 1.7835 2.25 2.75 2.25L4.49966 2.25L5.24966 2.25L5.24966 3.75L4.49966 3.75L2.75 3.75C2.61193 3.75 2.5 3.86193 2.5 4L2.5 13.2494C2.5 13.3875 2.61193 13.4994 2.75 13.4994L11.9997 13.4994C12.1377 13.4994 12.2497 13.3875 12.2497 13.2494L12.2497 11.5L12.2497 10.75L13.7497 10.75Z"}),(0,n.jsx)("path",{fill:"none",stroke:"currentcolor",d:"M7 8V3C7 2.44772 7.44772 2 8 2H13C13.5523 2 14 2.44772 14 3V8C14 8.55228 13.5523 9 13 9H8C7.44772 9 7 8.55228 7 8Z",strokeWidth:"1.5"})]})})}},7531:(e,t,l)=>{"use strict";l.d(t,{Ip:()=>m,K5:()=>p,Q2:()=>u,Rc:()=>d,kt:()=>f,tz:()=>c});var n=l(7336),i=l(80644),s=l(94484),a=l(4495),r=l(46462),o=l(24582);let c=e=>{let{...t}=e;return(0,n.jsx)(s.bL,{modal:!1,...t})};c.displayName=s.bL.displayName;let d=s.l9,u=i.forwardRef((e,t)=>{let{className:l,...i}=e;return(0,n.jsx)(s.YJ,{className:(0,a.cn)("p-1.5",l),ref:t,...i})});u.displayName=s.YJ.displayName,s.ZL,s.Pb,s.z6,i.forwardRef((e,t)=>{let{className:l,inset:i,variant:r="default",...o}=e;return(0,n.jsx)(s.ZP,{className:(0,a.cn)("[_>svg]:!text-gray-500 relative flex h-8 w-full select-none items-center gap-3 rounded-md px-1.5 text-sm text-gray-900 outline-none transition-colors data-[disabled]:pointer-events-none data-[state=open]:bg-gray-100 data-[disabled]:opacity-50 [&_svg]:size-4 [&_svg]:transition-colors",i&&"pl-8","destructive"===r?"text-red-700 focus:bg-[#FF666618] [&_svg]:!text-red-700":"text-gray-900 focus:bg-gray-100 [&_svg]:!text-gray-500",l),ref:t,...o})}).displayName=s.ZP.displayName,i.forwardRef((e,t)=>{let{className:l,sideOffset:i=12,...r}=e;return(0,n.jsx)(s.G5,{className:(0,a.cn)("bg-background-subtle z-50 min-w-[13.5rem] max-w-[28rem] overflow-hidden rounded-xl shadow-sm [&_svg]:shrink-0","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),ref:t,sideOffset:i,...r})}).displayName=s.G5.displayName;let m=i.forwardRef((e,t)=>{let{className:l,...i}=e;return(0,n.jsx)(s.ZL,{children:(0,n.jsx)(s.UC,{className:(0,a.cn)("bg-background-subtle z-50 min-w-[13.5rem] max-w-[28rem] overflow-hidden rounded-xl shadow-sm [&_svg]:shrink-0","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),ref:t,...i})})});m.displayName=s.UC.displayName;let f=i.forwardRef((e,t)=>{let{className:l,inset:i,variant:r="default",svgStyling:o=!0,...c}=e;return(0,n.jsx)(s.q7,{className:(0,a.cn)("relative flex h-8 w-full select-none items-center gap-3 whitespace-nowrap rounded-md px-1.5 text-sm text-gray-900 outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_span]:truncate",i&&"pl-8",o&&"[&_svg]:size-4 [&_svg]:transition-colors",o&&{"[&_svg]:!text-gray-500 [&[data-highlighted]_svg]:!text-gray-900":"default"===r,"[&_svg]:!text-red-700":"destructive"===r,"[&_svg]:!text-blue-700":"blue"===r,"[&_svg]:!text-amber-600":"gold"===r},"destructive"===r?"text-red-700 focus:bg-[#FF666618]":"text-gray-900 focus:bg-gray-100 ",l),ref:t,...c})});f.displayName=s.q7.displayName,i.forwardRef((e,t)=>{let{className:l,inset:i,...r}=e;return(0,n.jsx)(s.JU,{className:(0,a.cn)("h-8 content-center px-1.5 text-[13px] text-gray-500",i&&"pl-8",l),ref:t,...r})}).displayName=s.JU.displayName;let p=i.forwardRef((e,t)=>{let{className:l,...i}=e;return(0,n.jsx)(s.wv,{className:(0,a.cn)("h-px bg-gray-200",l),ref:t,...i})});p.displayName=s.wv.displayName,i.forwardRef((e,t)=>{let{className:l,children:i,checked:r,...c}=e;return(0,n.jsxs)(s.H_,{checked:r,className:(0,a.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),ref:t,...c,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(s.VF,{children:(0,n.jsx)(o.J,{className:"h-4 w-4"})})}),i]})}).displayName=s.H_.displayName,i.forwardRef((e,t)=>{let{className:l,children:i,...o}=e;return(0,n.jsxs)(s.hN,{className:(0,a.cn)("focus:bg-accent focus:text-accent-foreground relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l),ref:t,...o,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center rounded-full border",children:(0,n.jsx)(s.VF,{children:(0,n.jsx)(r.A,{className:"h-2 w-2 fill-current"})})}),i]})}).displayName=s.hN.displayName},9259:(e,t,l)=>{"use strict";l.r(t),l.d(t,{BlockContent:()=>lk,getBlockLogic:()=>ly,useRenderedBlock:()=>lw});var n=l(7336),i=l(80644),s=l(87608),a=l(65086),r=l(81792),o=l(2115),c=l(59103),d=l(24582),u=l(20287),m=l(51621),f=l(4495),p=l(49388);function h(e){let{show:t,axis:l,side:i,resizing:s,dotsHandle:a,onMouseDown:r,onFocus:o,onBlur:c,ref:d}=e,u={"aria-orientation":"x"===l?"vertical":"horizontal",onBlur:c,onFocus:o,onMouseDown:r,ref:d,role:"separator",tabIndex:0};return a?(0,n.jsx)("div",{className:(0,f.cn)("group absolute flex items-center justify-center focus:outline-none","x"===l?(0,f.cn)("inset-y-0 w-5 cursor-col-resize flex-col","start"===i?"left-[-19px]":"right-[-19px]"):(0,f.cn)("inset-x-0 h-5 cursor-row-resize flex-row","start"===i?"top-[-19px]":"bottom-[-19px]")),...u,children:(0,n.jsxs)("div",{className:"flex gap-0.5",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,n.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,n.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,n.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,n.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,n.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"}),(0,n.jsx)("div",{className:"size-[2.5px] rounded-full bg-gray-400 transition-colors duration-300 group-hover:bg-black group-focus:bg-black"})]})]})}):t?(0,n.jsx)("div",{className:(0,f.cn)("group absolute z-10 focus:outline-none","x"===l&&(0,f.cn)("inset-y-0 w-3 cursor-col-resize","start"===i?"-left-1.5":"-right-1.5"),"y"===l&&(0,f.cn)("inset-x-0 h-3 cursor-row-resize","start"===i?"-top-1.5":"-bottom-1.5")),...u,children:(0,n.jsx)("div",{className:(0,f.cn)("absolute inset-0 transition-all duration-200 group-hover:bg-gray-300 group-focus:bg-gray-400","x"===l&&(0,f.cn)("mx-auto group-hover:w-[3px] group-focus:w-[3px]",s?"w-1":"w-0"),"y"===l&&(0,f.cn)("my-auto group-hover:h-[3px] group-focus:h-[3px]",s?"h-1":"h-0"))})}):null}let x=(0,i.memo)(e=>{var t,l;let{show:s,innerClassName:a,dotsHandle:r=!1,onTrack:o,className:c,initialSize:d,animated:x=!0,minSizePx:v,minNegativeSpace:g,axis:b,side:j,children:y,cookieName:w,snapTo:k,onResize:N,ref:P}=e,E=(0,i.useRef)(null),C=(0,i.useRef)(null),S=(0,i.useRef)(null),[R,T]=(0,i.useState)(!1),[U,I]=(0,i.useState)(!1),[L,A]=(0,i.useState)(0),[M,_]=(0,i.useState)(0),[O,D]=(0,i.useState)(!1),z=(0,i.useState)(()=>{if("undefined"==typeof document)return null;let e=u.A.get(w);if(null===e)return null;let t=Number(e);return isNaN(t)?null:t})[0],F=(0,i.useRef)(null!=z?z:d);(0,i.useEffect)(()=>{P&&(P.current={setSize:e=>{F.current=e,E.current&&("x"===b?E.current.style.width="".concat(e,"%"):E.current.style.height="".concat(e,"%")),null==N||N(e)},getSize:()=>F.current,getContainer:()=>E.current})},[P,b,N]);let V=(0,i.useCallback)(e=>{var t,l,n,i;e.stopPropagation(),e.preventDefault(),null===(t=C.current)||void 0===t||t.focus(),I(!0),T(!0),A("x"===b?e.clientX:e.clientY),S.current=F.current,_(null!==(i="x"===b?null===(l=E.current)||void 0===l?void 0:l.clientWidth:null===(n=E.current)||void 0===n?void 0:n.clientHeight)&&void 0!==i?i:0),D(!0)},[b]),H=(0,i.useCallback)(e=>{var t,l;if(!R||!U)return;let n=null===(t=E.current)||void 0===t?void 0:t.parentElement,i=null!==(l="x"===b?null==n?void 0:n.clientWidth:null==n?void 0:n.clientHeight)&&void 0!==l?l:0,s=M+(L-("x"===b?e.clientX:e.clientY))*("start"===j?1:-1);k&&"y"===b&&s<k.threshold&&(s=k.size);let a=s/i*100;if(void 0!==g){let e=(i-g)/i*100;a>e&&(a=e)}"x"===b?E.current.style.width="".concat(a,"%"):E.current.style.height="".concat(a,"%"),F.current=a,null==N||N(a)},[b,U,R,j,L,M,k,g,N]),B=(0,i.useCallback)(()=>{var e;R&&(T(!1),I(!1),null===(e=C.current)||void 0===e||e.blur(),u.A.set(w,String(F.current),{expires:7}),null==o||o(S.current,F.current))},[w,o,R]);(0,p.ML)("mousemove",H),(0,p.ML)("mouseup",B),(0,p.ML)("keydown",e=>{var t,l,n,i,s;if(!R||"ArrowLeft"!==e.key&&"ArrowRight"!==e.key)return;let a=(e.shiftKey?12:4)*("ArrowLeft"===e.key?1:-1)*("start"===j?1:-1),r=null===(t=E.current)||void 0===t?void 0:t.parentElement,o=null!==(i="x"===b?null==r?void 0:r.clientWidth:null==r?void 0:r.clientHeight)&&void 0!==i?i:0,c=(null!==(s="x"===b?null===(l=E.current)||void 0===l?void 0:l.clientWidth:null===(n=E.current)||void 0===n?void 0:n.clientHeight)&&void 0!==s?s:0)/o*100+a;if(k&&"y"===b&&c/100*o<k.threshold&&(c=k.size/o*100),void 0!==g){let e=(o-g)/o*100;c>e&&(c=e)}"x"===b?E.current.style.width="".concat(c,"%"):E.current.style.height="".concat(c,"%"),F.current=c},C);let W=(0,i.useCallback)(()=>{var e;if(void 0===g)return;let t=null===(e=E.current)||void 0===e?void 0:e.parentElement,l="x"===b?null==t?void 0:t.clientWidth:null==t?void 0:t.clientHeight;if(l)return(l-g)/l*100},[b,g]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:(0,f.cn)("fixed inset-0 z-50",R?"x"===b?"cursor-col-resize":"cursor-row-resize":"pointer-events-none")}),(0,n.jsxs)(m.P.div,{animate:"x"===b?{width:s?"".concat(null!==(t=F.current)&&void 0!==t?t:d,"%"):"0%",height:"100%",minWidth:s?"".concat(v,"px"):0,maxWidth:s&&g?"".concat(W(),"%"):void 0,opacity:+!!s}:{height:s?"".concat(null!==(l=F.current)&&void 0!==l?l:d,"%"):"0%",width:"100%",minHeight:s?"".concat(v,"px"):0,maxHeight:s&&g?"".concat(W(),"%"):void 0,opacity:+!!s},"aria-hidden":!s,className:(0,f.cn)("relative",c),inert:!s,initial:!1,layout:"size",onAnimationComplete:()=>{O&&D(!1)},ref:E,transition:O||!x?{type:!1}:{type:"spring",damping:25,stiffness:180,mass:1},children:[(0,n.jsx)(h,{axis:b,dotsHandle:r,onBlur:B,onFocus:()=>{T(!0),D(!0)},onMouseDown:V,ref:C,resizing:R,show:s,side:j}),(0,n.jsx)("div",{className:(0,f.cn)("absolute inset-0",a),children:y})]})]})});x.displayName="Resizable";var v=l(48963),g=l(66818),b=l(81616),j=l(97210),y=l(77215);function w(e){let{buttonText:t="Run Code",variant:l="default",setOutput:s,codeExecutionBlockProps:a,execute:r,editedValue:c,disabled:d}=e,[u,m]=(0,i.useState)(!1);return(0,n.jsxs)(b.$,{className:"ghost"===l?"h-6 text-gray-500 has-[>svg]:px-1":"","data-testid":"run-code-button",disabled:u||d,onClick:async()=>{try{m(!0),(0,o.u)("ClickRunCode",{code:c||a.source});let e=await r(a,c);s(e)}finally{m(!1)}},size:"sm",variant:"ghost"===l?"ghost":"secondary",children:[u?(0,n.jsx)(j.y,{size:16,wrapperClassName:"text-gray-500"}):(0,n.jsx)(y.N,{className:(0,f.cn)("translate-y-[-0.5px] [&_circle]:[vector-effect:non-scaling-stroke]","ghost"===l?"text-gray-500 [&_path]:fill-gray-500":"text-gray-900 [&_path]:fill-gray-900")}),t]},"execute")}var k=l(52295),N=l(22931),P=l(98335),E=l(55681),C=l(74702);function S(e){let{size:t=16,className:l}=e;return(0,n.jsxs)("svg",{className:(0,f.cn)("trash-icon overflow-visible",l),fill:"currentColor",height:t,viewBox:"0 0 16 16",width:t,xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("style",{children:"\n        .trash-icon .trash-lid {\n            transition: transform 0.35s cubic-bezier(0.35, 0.2, 0.14, 0.95);\n            transform-origin: center;\n        }\n\n        button:has(.trash-icon):hover .trash-lid, button:has(.trash-icon):focus-visible .trash-lid {\n          transform: translate(-0px, -2px) rotate(-10deg);\n        }\n            \n       "}),(0,n.jsx)("path",{className:"trash-lid",clipRule:"evenodd",d:"M6.75 2.75C6.75 2.0596 7.3096 1.5 8 1.5 8.6904 1.5 9.25 2.0596 9.25 2.75V3H6.75V2.75ZM5.25 3V2.75C5.25 1.2312 6.4812 0 8 0 9.5188 0 10.75 1.2312 10.75 2.75V3H12.9201 13 15V4.5H14.25 13.8846 1.75 1V3H1.75 3.0799 5.25Z",fill:"currentColor",fillRule:"evenodd"}),(0,n.jsx)("path",{clipRule:"evenodd",d:"M2.1154 4.5H13.8846L13.1776 13.6917C13.0774 14.9942 11.9913 16 10.6849 16H5.3151C4.0087 16 2.9226 14.9942 2.8224 13.6917L2.1154 4.5ZM4.318 13.5767 3.6198 4.5H12.3802L11.682 13.5767C11.6419 14.0977 11.2075 14.5 10.6849 14.5H5.3151C4.7925 14.5 4.3581 14.0977 4.318 13.5767Z",fill:"currentColor",fillRule:"evenodd"})]})}var R=l(93642),T=l(58978),U=l(72070),I=l(42975),L=l(53616),A=l(64459),M=l(65410),_=l(74654),O=l(67952);let D=e=>{if(!e)return;let t=document.getElementById((0,I.j)(e));if(t instanceof HTMLIFrameElement){if(t.contentDocument)t.contentDocument.location.reload();else if(t.srcdoc){let e=t.srcdoc;t.srcdoc="",setTimeout(()=>{t.srcdoc=e},10)}else t.src=t.src}};function z(e){let{blockId:t}=e,l=(0,O.k)("previewBlock"),s=(0,i.useCallback)(()=>{t&&D(t)},[t]);return(0,n.jsx)(v.Z,{"aria-label":l("refresh"),onClick:()=>s(),tooltip:{side:"bottom",content:l("refresh")},children:(0,n.jsx)("span",{children:(0,n.jsx)(_.g,{})})})}var F=l(47192),V=l(25339);function H(){let{setFullscreenResult:e}=(0,F.S)(),t=(0,O.k)("previewBlock");return(0,n.jsx)(v.Z,{"aria-label":t("fullscreen"),className:"hidden md:flex",onClick:()=>e(!0),tooltip:{side:"bottom",content:t("fullscreen")},children:(0,n.jsx)(V.g,{})})}var B=l(45459),W=l(13154),Z=l.n(W),G=l(11192),$=l(15993),K=l(79822),Q=l(84274),X=l(55200),Y=l(55556);let q=(0,G.default)(()=>Promise.all([l.e(28),l.e(1944)]).then(l.bind(l,91944)).then(e=>e.ConflictEditor),{loadableGenerated:{webpack:()=>[91944]}});function J(e){let{hasUnappliedChanges:t,blockId:l,source:s,onApply:a,showFadeOut:r}=e,[o,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)(!1),f=(0,O.k)("unappliedChanges"),[p,h]=(0,i.useState)(null),[x,v]=(0,i.useState)(null),g=async()=>{c(!0);let e=await fetch("/chat/api/chat/remote/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bid:l,blockSource:s})});if(c(!1),e.ok){let t=await e.json();t.success?(u(!0),setTimeout(()=>u(!1),2e3),$.oR.success(f("savedChanges"))):($.oR.error("Local: conflict detected. Check your console"),h(t.conflicts)),a()}else $.oR.error(f("failedToApplyChanges"))},y=async()=>{if(x)try{let e=[...(0,Y.A2)({source:s,blockType:"local",blockId:l})];for(let t of x){let l=e.find(e=>e.meta.file===t.file);l&&(l.source=t.content)}let t=(0,Y.L5)({files:e,blockType:"local"}),n=await fetch("/chat/api/chat/remote/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bid:l,blockSource:t,resolvedConflicts:!0})});n.ok&&(await n.json()).success?(u(!0),setTimeout(()=>u(!1),2e3),$.oR.success(f("savedChanges")),a(),h(null)):$.oR.error(f("failedToApplyChanges"))}catch(e){$.oR.error(f("failedToApplyChanges"))}},w=(0,i.useCallback)(e=>{e.every(e=>e.resolved)?v(e):v(null)},[]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(K.N,{children:t&&!d?(0,n.jsxs)(n.Fragment,{children:[r?(0,n.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"from-muted pointer-events-none absolute inset-x-0 bottom-0 z-10 flex h-36 items-end justify-center bg-gradient-to-t to-transparent"},"unsaved-changes-bg"):null,(0,n.jsx)(m.P.div,{initial:{opacity:0,y:20,scale:.95,width:320},animate:{opacity:1,y:0,scale:1,width:o?96:320},exit:{opacity:0},transition:{duration:.15,ease:"easeOut",width:{type:"spring",stiffness:300,damping:30}},className:"shadow-modal bg-background absolute inset-x-0 bottom-3 z-50 mx-auto flex h-11 items-center justify-between rounded-full p-2 pl-3 text-sm font-medium",children:o?(0,n.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,n.jsx)(j.y,{size:16}),"Saving"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(Q.N,{className:"!text-gray-500"}),"Unsaved Changes"]}),(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsx)(b.$,{size:"sm",className:"h-7",rounded:!0,disabled:o,onClick:g,children:f("apply")})})]})},"unsaved-changes-island")]}):null}),(0,n.jsx)(X.lG,{open:null!==p,children:(0,n.jsxs)(X.Cf,{className:"max-h-[90vh] w-full max-w-[90vw] overflow-auto",children:[(0,n.jsxs)(X.c7,{children:[(0,n.jsx)(X.L3,{children:"Conflict Detected"}),(0,n.jsx)(X.rr,{children:"Please resolve them before saving."})]}),(0,n.jsx)(i.Suspense,{fallback:(0,n.jsx)(j.y,{}),children:p?(0,n.jsx)(q,{conflicts:p,onEdit:w}):null}),(0,n.jsxs)(X.Es,{children:[(0,n.jsx)(b.$,{variant:"secondary",onClick:()=>{alert("You must resolve conflicts before continuing")},children:"Cancel"}),(0,n.jsx)(b.$,{onClick:y,disabled:null===x,children:"Confirm"})]})]})})]})}var ee=l(90923),et=l(76308),el=l(92734),en=l(74897),ei=l(25257),es=l(13184),ea=l(46556),er=l(9044),eo=l(83748),ec=l(7531),ed=l(45333),eu=l(84382);function em(e){return(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 13.5V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V8H3V1.5H8V5V6.5H9.5H13V13.5C13 14.0523 12.5523 14.5 12 14.5H6V16H12C13.3807 16 14.5 14.8807 14.5 13.5ZM9.5 5V2.12132L12.3787 5H9.5ZM2.31885 12.8194H0V11.3194H2.31885V9H3.81885V11.3194H6.13775V12.8194H3.81885V15.1377H2.31885V12.8194Z",fill:"currentColor"})})}function ef(){return(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("path",{d:"M11.3333 8H2",stroke:"currentcolor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M7.33325 12L11.3333 8L7.33325 4",stroke:"currentcolor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M14 3.33203V12.6654",stroke:"currentcolor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}var ep=l(66544),eh=l(2829),ex=l(38559),ev=l(52220),eg=l(77055),eb=l(95110),ej=l(19895);function ey(e){let t=(0,ej.eu)(),{updateBlockData:l}=(0,eb.P6)({blockId:e}),n=(0,ej.y6)();return async function(i,s){let a=(0,Y.L5)({files:i,blockType:"code-project"}),r=await (0,eg.Z)({blockId:e,source:a,movedFile:null==s?void 0:s.moveFile});return r.transformedSource&&(a=r.transformedSource),t&&e===t.id&&n({...t,hasSourceBeenEdited:!0,source:a}),l({blockId:e,data:{hasSourceBeenEdited:!0,source:a}}),r}}function ew(){let{data:e,mutate:t}=(0,c.Ay)("showNewFileDialog",null,{fallbackData:!1}),{data:l,mutate:n}=(0,c.Ay)("newFileDialogData",null,{fallbackData:{folderName:""}});return{newFileDialogData:l,setNewFileDialogData:n,showNewFileDialog:e,setShowNewFileDialog:t}}function ek(e){let{blockId:t,sourceFiles:l,onSuccess:s}=e,{newFileDialogData:a,showNewFileDialog:r,setShowNewFileDialog:o}=ew(),c=ey(t),[d,u]=(0,i.useState)(!1),[m,f]=(0,i.useState)(""),p=(0,O.k)("fileTreeActions");(0,i.useEffect)(()=>{r&&f("")},[r]);let h=(0,i.useCallback)(async e=>{e.preventDefault();try{u(!0);let e="".concat(a.folderName,"/").concat(m);a.folderName||(e=m);let n=m.split(".").pop(),i={source:"",meta:{file:e},blockId:t,lang:(0,ep.SR)(n),isDeleted:!1,isEdit:!1,isMerged:!1,isMoved:!1,isLocked:!1,isFixed:!1,isQuickEdit:!1,isTerminated:!1,isAttachmentQuickEdit:!1,isUserEdit:!0};if((await c([...l,i])).success)null==s||s();else throw Error("Failed")}catch(e){$.oR.error(p("newFileNotificationError"))}finally{u(!1)}},[t,l,a,s,p,c,m]);return(0,n.jsxs)(ex.Modal,{onOpenChange:o,open:r,responsive:!1,children:[(0,n.jsx)(ex.ModalHeader,{children:(0,n.jsx)(ex.ModalTitle,{children:p("newFile")})}),(0,n.jsx)(ex.ModalContent,{children:(0,n.jsx)("form",{className:"flex flex-col gap-6",onSubmit:h,children:(0,n.jsx)(ev.p,{onChange:e=>f(e.target.value),disabled:d,value:m})})}),(0,n.jsxs)(ex.ModalFooter,{children:[(0,n.jsx)(ex.ModalClose,{asChild:!0,children:(0,n.jsx)(b.$,{size:"sm",variant:"secondary",children:p("cancel")})}),(0,n.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:d,onClick:h,size:"sm",children:d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eh.IconSpinner,{className:"size-4"}),p("creating")]}):p("create")})]})]})}function eN(){let{data:e,mutate:t}=(0,c.Ay)("showDeleteFileDialog",null,{fallbackData:!1}),{data:l,mutate:n}=(0,c.Ay)("deleteFileDialogData",null,{fallbackData:{fileName:""}});return{showDeleteFileDialog:e,setShowDeleteFileDialog:t,deleteFileDialogData:l,setDeleteFileDialogData:n}}function eP(e){let{blockId:t,sourceFiles:l,onSuccess:s}=e,{showDeleteFileDialog:a,setShowDeleteFileDialog:r,deleteFileDialogData:o}=eN(),c=ey(t),[d,u]=(0,i.useState)(!1),m=(0,O.k)("fileTreeActions"),f=(0,i.useCallback)(async()=>{try{u(!0);let e=[...l];for(let t of e)if(t.meta.file===o.fileName){t.source="... deleted ...",t.isDeleted=!0,t.isUserEdit=!0,t.isMerged=!1,t.moveToEnd=!0;break}if((await c(e)).success)null==s||s();else throw Error("Failed")}catch(e){$.oR.error(m("fileDeletedNotificationError"))}finally{u(!1)}},[o,l,s,c,m]);return(0,n.jsxs)(ex.Modal,{onOpenChange:r,open:a,responsive:!1,children:[(0,n.jsx)(ex.ModalHeader,{children:(0,n.jsx)(ex.ModalTitle,{children:m("deleteFile")})}),(0,n.jsx)(ex.ModalContent,{children:(0,n.jsxs)("p",{children:["Are you sure you want to delete"," ",(0,n.jsx)("span",{className:"font-bold",children:o.fileName}),"?"]})}),(0,n.jsxs)(ex.ModalFooter,{children:[(0,n.jsx)(ex.ModalClose,{asChild:!0,children:(0,n.jsx)(b.$,{size:"sm",variant:"secondary",children:m("cancel")})}),(0,n.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:d,onClick:f,size:"sm",variant:"destructive",children:d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eh.IconSpinner,{className:"size-4"}),m("deleting")]}):m("delete")})]})]})}function eE(){let{data:e,mutate:t}=(0,c.Ay)("showDeleteFolderDialog",null,{fallbackData:!1}),{data:l,mutate:n}=(0,c.Ay)("deleteFolderDialogData",null,{fallbackData:{folderName:"",source:""}});return{deleteFolderDialogData:l,setDeleteFolderDialogData:n,showDeleteFolderDialog:e,setShowDeleteFolderDialog:t}}function eC(e){let{blockId:t,sourceFiles:l,onSuccess:s}=e,{deleteFolderDialogData:a,showDeleteFolderDialog:r,setShowDeleteFolderDialog:o}=eE(),c=ey(t),[d,u]=(0,i.useState)(!1),m=(0,O.k)("fileTreeActions"),f=(0,i.useCallback)(async()=>{try{u(!0);let e=[...l];for(let t of e)(t.meta.file.startsWith(a.folderName+"/")?a.source:void 0)&&(t.source="... deleted ...",t.isDeleted=!0,t.isUserEdit=!0,t.isMerged=!1,t.moveToEnd=!0);if((await c(e)).success)null==s||s();else throw Error("Failed")}catch(e){$.oR.error(m("folderDeletedNotificationError"))}finally{u(!1)}},[a,l,s,c,m]);return(0,n.jsxs)(ex.Modal,{onOpenChange:o,open:r,responsive:!1,children:[(0,n.jsx)(ex.ModalHeader,{children:(0,n.jsx)(ex.ModalTitle,{children:m("deleteFolder")})}),(0,n.jsx)(ex.ModalContent,{children:(0,n.jsxs)("p",{className:"mb-2",children:["Are you sure you want to delete"," ",(0,n.jsx)("span",{className:"font-bold",children:a.folderName}),"?"]})}),(0,n.jsxs)(ex.ModalFooter,{children:[(0,n.jsx)(ex.ModalClose,{asChild:!0,children:(0,n.jsx)(b.$,{size:"sm",variant:"secondary",children:m("cancel")})}),(0,n.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:d,onClick:f,size:"sm",variant:"destructive",children:d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eh.IconSpinner,{className:"size-4"}),m("deleting")]}):m("delete")})]})]})}function eS(){let{data:e,mutate:t}=(0,c.Ay)("showNewFolderDialog",null,{fallbackData:!1}),{data:l,mutate:n}=(0,c.Ay)("newFolderDialogData",null,{fallbackData:{folderName:""}});return{newFolderDialogData:l,setNewFolderDialogData:n,showNewFolderDialog:e,setShowNewFolderDialog:t}}function eR(e){let{onSuccess:t}=e,{newFolderDialogData:l,showNewFolderDialog:s,setShowNewFolderDialog:a}=eS(),[r,o]=(0,i.useState)(!1),[c,d]=(0,i.useState)(""),u=(0,O.k)("fileTreeActions");(0,i.useEffect)(()=>{s&&d("")},[s]);let m=(0,i.useCallback)(e=>{e.preventDefault(),o(!0);let n=l.folderName?"".concat(l.folderName,"/").concat(c):c;null==t||t(n),o(!1)},[l,t,c]);return(0,n.jsxs)(ex.Modal,{onOpenChange:a,open:s,responsive:!1,children:[(0,n.jsx)(ex.ModalHeader,{children:(0,n.jsx)(ex.ModalTitle,{children:u("newFolder")})}),(0,n.jsx)(ex.ModalContent,{children:(0,n.jsx)("form",{className:"flex flex-col gap-6",onSubmit:m,children:(0,n.jsx)(ev.p,{onChange:e=>d(e.target.value),disabled:r,value:c})})}),(0,n.jsxs)(ex.ModalFooter,{children:[(0,n.jsx)(ex.ModalClose,{asChild:!0,children:(0,n.jsx)(b.$,{size:"sm",variant:"secondary",children:u("cancel")})}),(0,n.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:r,onClick:m,size:"sm",children:r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eh.IconSpinner,{className:"size-4"}),u("creating")]}):u("create")})]})]})}function eT(){let{data:e,mutate:t}=(0,c.Ay)("showRenameFileDialog",null,{fallbackData:!1}),{data:l,mutate:n}=(0,c.Ay)("renameFileDialogData",null,{fallbackData:{fileName:""}});return{renameFileDialogData:l,setRenameFileDialogData:n,showRenameFileDialog:e,setShowRenameFileDialog:t}}function eU(e){let{blockId:t,sourceFiles:l,onSuccess:s}=e,{renameFileDialogData:a,showRenameFileDialog:r,setShowRenameFileDialog:o}=eT(),c=ey(t),[d,u]=(0,i.useState)(!1),[m,f]=(0,i.useState)(""),p=(0,O.k)("fileTreeActions");(0,i.useEffect)(()=>{f(a.fileName.split("/").slice(-1)[0])},[a.fileName]);let h=(0,i.useCallback)(async e=>{e.preventDefault();try{u(!0);let e=[...l],t=e.findIndex(e=>e.meta.file===a.fileName),n=a.fileName.split("/").slice(0,-1).join("/"),i=n?"".concat(n,"/").concat(m):m;if(e[t].meta.file=i,e[t].isMoved=!0,e[t].isUserEdit=!0,(await c([...e],{moveFile:{from:a.fileName,to:i}})).success)null==s||s(i);else throw Error("Failed")}catch(e){$.oR.error(p("renameFileNotificationError"))}finally{u(!1)}},[l,s,a,p,c,m]);return(0,n.jsxs)(ex.Modal,{onOpenChange:o,open:r,responsive:!1,children:[(0,n.jsx)(ex.ModalHeader,{children:(0,n.jsx)(ex.ModalTitle,{children:p("renameFile")})}),(0,n.jsx)(ex.ModalContent,{children:(0,n.jsx)("form",{className:"flex flex-col gap-6",onSubmit:h,children:(0,n.jsx)(ev.p,{onChange:e=>f(e.target.value),disabled:d,value:m})})}),(0,n.jsxs)(ex.ModalFooter,{children:[(0,n.jsx)(ex.ModalClose,{asChild:!0,children:(0,n.jsx)(b.$,{size:"sm",variant:"secondary",children:p("cancel")})}),(0,n.jsx)(b.$,{"data-testid":"confirm-delete-message",disabled:d,onClick:h,size:"sm",children:d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eh.IconSpinner,{className:"size-4"}),p("renaming")]}):p("rename")})]})]})}function eI(e){let{className:t,...l}=e;return(0,n.jsxs)("svg",{className:(0,f.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",...l,children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13 10.4V11.2H10.6V10.4C10.6 9.73726 11.1373 9.2 11.8 9.2C12.4627 9.2 13 9.73726 13 10.4ZM9.4 11.2V10.4C9.4 9.07452 10.4745 8 11.8 8C13.1255 8 14.2 9.07452 14.2 10.4V11.2H15V14.8C15 15.4627 14.4627 16 13.8 16H9.8C9.13726 16 8.6 15.4627 8.6 14.8V11.2H9.4Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 7V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V13.5C1.5 14.8807 2.61929 16 4 16H7V14.5H4C3.44772 14.5 3 14.0523 3 13.5V1.5H8V5V6.5H9.5H13V7H14.5ZM9.5 5V2.12132L12.3787 5H9.5Z",fill:"currentColor"})]})}function eL(e){let{className:t,...l}=e;return(0,n.jsxs)("svg",{className:(0,f.cn)("h-4 w-4",t),fill:"none",height:"16",viewBox:"0 0 16 16",width:"16",xmlns:"http://www.w3.org/2000/svg",...l,children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.39997 10.7499C9.39997 10.1148 8.8851 9.5999 8.24997 9.5999C7.61485 9.5999 7.09997 10.1148 7.09997 10.7499V11.1428H5.89997V10.7499C5.89997 9.45203 6.95211 8.3999 8.24997 8.3999C9.54784 8.3999 10.6 9.45203 10.6 10.7499V11.2H15V14.8C15 15.4627 14.4627 16 13.8 16H9.8C9.13725 16 8.59999 15.4627 8.59999 14.8V11.2H9.39997V10.7499Z",fill:"currentColor"}),(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 10V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V13.5C1.5 14.8807 2.61929 16 4 16H7V14.5H4C3.44772 14.5 3 14.0523 3 13.5V1.5H8V5V6.5H9.5H13V10H14.5ZM9.5 5V2.12132L12.3787 5H9.5Z",fill:"currentColor"})]})}let eA=e=>{let{blockId:t,sourceFiles:l,onChange:n}=e,s=ey(t),a=(0,O.k)("fileTreeActions"),[r,c]=(0,i.useState)(null);return{handleToggleFileLock:(0,i.useCallback)(async e=>{let i,r;let d=[...l],u="locking";for(let t of d)if(("single-file"!==e.variant||t.meta.file===e.fileNameToEdit)&&("folder"!==e.variant||t.meta.file.startsWith(e.folderName+"/"))&&(("single-file"===e.variant&&t.isLocked||"all-files"===e.variant&&"unlock"===e.mode||"folder"===e.variant&&"unlock"===e.mode)&&(u="unlocking"),"single-file"===e.variant?t.isLocked=!t.isLocked:t.isLocked="lock"===e.mode,"single-file"===e.variant))break;"all-files"===e.variant?c({type:"locking"===u?"locking-all":"unlocking-all"}):"folder"===e.variant?c({type:"locking"===u?"locking-folder":"unlocking-folder",folderName:e.folderName}):c({type:u,fileName:e.fileNameToEdit});try{i=await s(d)}catch(e){i={success:!1}}r="single-file"===e.variant?"locking"===u?"fileLockedNotification":"fileUnlockNotification":"locking"===u?"filesLockedNotification":"filesUnlockedNotification",c(null),i.success?((0,o.u)("LockFiles",{variant:e.variant,state:u,blockId:t}),$.oR.success(a(r),{position:"bottom-right"}),n()):((0,o.u)("LockFilesError",{variant:e.variant,state:u,blockId:t}),console.error(i),$.oR.error(a("fileLockNotificationError"),{position:"bottom-right"}))},[l,s,a,n,t]),lockingStatus:r}},eM="file-tree-panel-right",e_="file-tree-panel-left";function eO(e){let{showDiffInfo:t,activeFilePath:l,initialFileTreeSize:s,setActiveFile:a,children:r,files:o,loadingPath:d,blockId:u,source:m,onChange:p}=e,[h,x]=(0,i.useState)(!!(null==o?void 0:o.length)),{defaultSizeRef:v,isFallbackSize:g}=(0,el.Zf)({initialSize:s,fallbackSize:15}),j=(0,i.useRef)(!1),{setDeleteFileDialogData:y,setShowDeleteFileDialog:w}=eN(),{setDeleteFolderDialogData:k,setShowDeleteFolderDialog:P}=eE(),{setRenameFileDialogData:E,setShowRenameFileDialog:C}=eT(),{newFileDialogData:S,setNewFileDialogData:R,setShowNewFileDialog:T}=ew(),{setNewFolderDialogData:U,setShowNewFolderDialog:I}=eS(),{tempFolders:L,setTempFolders:A}=function(e){let{blockId:t}=e,{data:l,mutate:n}=(0,c.Ay)(["tempFolders",t],null,{fallbackData:[]});return{tempFolders:l,setTempFolders:n}}({blockId:u}),M=ey(u);(0,i.useEffect)(()=>{!j.current&&(null==o?void 0:o.length)&&x(!!o.length)},[o]);let _=(0,i.useMemo)(()=>{let e=o?o.map(e=>["file"in e.meta?e.meta.file:"",e]):[];for(let t of L||[])e.push([t,null]);let l=[];for(let[n,i]of e){let e=n.split("/"),s=l;for(let[l,n]of e.entries()){let a=l===e.length-1&&null!==i,r=e.slice(0,l+1).join("/"),o=s.find(e=>e.title===n);if(!o){let e={title:n,value:r,isLocked:(null==i?void 0:i.isLocked)||!1,type:a?i.meta.url?"binary":"text":"directory"},l=null==i?void 0:i.originalCode,c=null==i?void 0:i.source;if(a){if(t&&l&&l!==c&&c){let t=(0,ed.G)(l,c);e.addedCount=t.filter(e=>e.added).length,e.removedCount=t.filter(e=>e.removed).length}else t&&c&&!l&&(e.addedCount=c.split("\n").length,e.removedCount=0)}else e.items=[];s.push(e),o=e}a||(s=o.items||[])}}return l},[o,t,L]),O=(0,i.useMemo)(()=>(0,Y.A2)({source:m,blockType:"code-project",blockId:u}),[m,u]),D=(0,i.useMemo)(()=>{let e=0,t=l=>{for(let n of l)n.items?t(n.items):e++};return t(_),e},[_]),{handleToggleFileLock:z,lockingStatus:F}=eA({sourceFiles:O,blockId:u,onChange:p}),V=(0,i.useCallback)(e=>{let{item:t}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(ec.kt,{onSelect:()=>z({fileNameToEdit:t.value,variant:"single-file"}),children:[t.isLocked?(0,n.jsx)(er.e,{}):(0,n.jsx)(ea.C,{}),(0,n.jsx)("span",{children:t.isLocked?"Unlock":"Lock"})]}),(0,n.jsxs)(ec.kt,{onSelect:()=>z({mode:"lock",variant:"all-files"}),children:[(0,n.jsx)(eI,{}),"Lock All"]}),(0,n.jsxs)(ec.kt,{onSelect:()=>z({mode:"unlock",variant:"all-files"}),children:[(0,n.jsx)(eL,{}),"Unlock All"]}),(0,n.jsx)(ec.K5,{}),(0,n.jsxs)(ec.kt,{onSelect:()=>{C(!0),E({fileName:t.value})},children:[(0,n.jsx)(eu.A,{}),"Rename"]}),(0,n.jsxs)(ec.kt,{onSelect:async()=>{try{let e;let l=O.find(e=>e.meta.file===t.value);if(!l)throw Error("File not found");let n=l.meta.file.split("/"),i=n[n.length-1],s=n.length>1?n.slice(0,-1).join("/"):"",a=i.split("."),r=a.reverse().pop()||"",o=a.reverse().join("."),c=r.match(/-copy(-(\d+))?$/),d=r,m=c?c[2]?parseInt(c[2])+1:2:1;do d=c?r.replace(/-copy(-\d+)?$/,"-copy-".concat(m)):"".concat(r,"-copy").concat(m>1?"-".concat(m):""),e="".concat(s?"".concat(s,"/"):"").concat(d).concat(o?".".concat(o):""),m++;while(O.some(t=>t.meta.file===e));let f={source:l.source,meta:{file:e},blockId:u,lang:(0,ep.SR)(o),isDeleted:!1,isEdit:!1,isMerged:!1,isMoved:!1,isFixed:!1,isQuickEdit:!1,isTerminated:!1,isAttachmentQuickEdit:!1,isLocked:!1,isUserEdit:!0};if((await M([...O,f])).success)p();else throw Error("Failed")}catch(e){throw Error("Failed")}},children:[(0,n.jsx)(es.z,{}),(0,n.jsx)("span",{children:"Duplicate"})]}),(0,n.jsxs)(ec.kt,{variant:"destructive",onSelect:()=>{w(!0),y({fileName:t.value})},children:[(0,n.jsx)(eo.l,{}),"Delete"]})]})},[u,p,y,E,w,C,z,O,M]),H=(0,i.useCallback)(e=>{let{item:t}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(ec.kt,{onSelect:()=>{R({folderName:t.value}),T(!0)},children:[(0,n.jsx)(em,{}),"New File"]}),(0,n.jsxs)(ec.kt,{onSelect:()=>{U({folderName:t.value}),I(!0)},children:[(0,n.jsx)(ei.J,{}),"New Folder"]}),(0,n.jsx)(ec.K5,{}),(0,n.jsxs)(ec.kt,{onSelect:()=>z({variant:"folder",mode:"lock",folderName:t.value}),children:[(0,n.jsx)(eI,{}),"Lock Folder"]}),(0,n.jsxs)(ec.kt,{onSelect:()=>z({variant:"folder",mode:"unlock",folderName:t.value}),children:[(0,n.jsx)(eL,{}),"Unlock Folder"]}),(0,n.jsx)(ec.K5,{}),(0,n.jsxs)(ec.kt,{variant:"destructive",onSelect:()=>{A(e=>(e||[]).filter(e=>e!==t.value)),P(!0),k({folderName:t.value,source:m})},children:[(0,n.jsx)(eo.l,{}),"Delete"]})]})},[k,R,U,P,A,I,z,T,m]),B=(0,i.useCallback)(()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(ec.kt,{onSelect:()=>{T(!0),R({folderName:""})},children:[(0,n.jsx)(em,{}),"New File"]}),(0,n.jsxs)(ec.kt,{onSelect:()=>{I(!0),U({folderName:""})},children:[(0,n.jsx)(ei.J,{}),"New Folder"]}),(0,n.jsx)(ec.K5,{}),(0,n.jsxs)(ec.kt,{onSelect:()=>z({mode:"lock",variant:"all-files"}),children:[(0,n.jsx)(eI,{}),"Lock All"]}),(0,n.jsxs)(ec.kt,{onSelect:()=>z({mode:"unlock",variant:"all-files"}),children:[(0,n.jsx)(eL,{}),"Unlock All"]})]}),[T,z,R,I,U]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(el.YZ,{isFallbackSize:g,collapseSide:"left",cookie:N.ao,id:"file-tree-panel-group",className:"h-screen w-screen",direction:"horizontal",leftId:e_,rightId:eM,defaultSizeRef:v,children:[(0,n.jsx)(el.je,{className:"z-10 h-full min-w-[160px]",collapseSide:"left",isOpen:D>1&&h,order:1,defaultSize:v.current,collapseId:e_,children:(0,n.jsx)(i.Suspense,{fallback:null,children:(0,n.jsx)("div",{className:"bg-muted flex h-full flex-col",children:(0,n.jsx)(et.h,{loading:d,active:l,onSelect:a,lockingStatus:F,className:"w-full flex-1 overflow-y-auto p-1.5 pb-12",items:_,FileActions:V,FolderActions:H,TreeActions:B})})})}),(0,n.jsx)(en.Zk,{id:eM,order:2,defaultSize:h?100-v.current:100,className:"h-full min-w-[200px]",children:r}),D>1?(0,n.jsx)(b.$,{tooltip:"".concat(h?"Close":"Open"," File Tree"),className:(0,f.cn)("absolute bottom-2 left-2 z-20 size-7 transition-all",h?"-scale-x-100":""),variant:"secondary",size:"sm",onClick:()=>{j.current=!0,x(!h)},children:(0,n.jsx)(ef,{},"arrow")},"button"):null]}),(0,n.jsx)(eP,{blockId:u,sourceFiles:O,onSuccess:()=>{w(!1),p()}}),(0,n.jsx)(eC,{blockId:u,sourceFiles:O,onSuccess:()=>{P(!1),p()}}),(0,n.jsx)(ek,{blockId:u,sourceFiles:O,onSuccess:()=>{T(!1),p()}}),(0,n.jsx)(eR,{onSuccess:e=>{A(t=>Array.from(new Set([...t||[],e]))),I(!1),p()}}),(0,n.jsx)(eU,{blockId:u,sourceFiles:O,onSuccess:e=>{e&&l===S.fileName&&a(e),C(!1),p()}})]})}var eD=l(8871),ez=l(40255),eF=l(35339);function eV(e){let{data:t,mutate:l}=(0,c.Ay)(["block:consoleEvents",e],{fallbackData:{}});return{blockStatus:null!=t?t:{},flagNewEvent:(0,i.useCallback)(t=>l(l=>({...l,[e]:l&&"error"===l[e]?"error":t})),[e,l]),clearEvents:(0,i.useCallback)(()=>l(t=>{let l={...t};return l[e]=null,l}),[e,l])}}var eH=l(32178);function eB(e){let{data:t,mutate:l}=(0,c.Ay)(["block:file-editing-status",e],{fallbackData:!1});return[t,(0,i.useCallback)(e=>{l(e)},[l])]}var eW=l(57748),eZ=l(9207),eG=l(26939),e$=l(43832),eK=l(11537),eQ=l(73268),eX=l(21491),eY=l(99942),eq=l(85328),eJ=l(53508),e0=l(95813),e1=l(85323);function e5(e){let{event:t,canWriteToChat:l,onAskV0:i}=e;return(0,n.jsxs)("div",{className:"flex items-start gap-4 px-2 py-1 font-mono text-sm",children:[(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)("time",{className:"text-[13px]",children:[(0,eQ.GP)(new Date(t.timestamp),"HH:mm:ss.SSS"),"Z"]}),t.isServer&&(0,n.jsx)("span",{className:"rounded-full bg-gray-100 px-2 py-0.5 text-xs font-medium text-gray-600",children:"[SERVER]"})]}),(0,n.jsx)("div",{className:"w-full flex-1 whitespace-pre-wrap text-[13px]",children:t.message}),l&&"error"===t.method&&(0,n.jsx)("div",{className:"absolute right-3 top-0.5 opacity-0 transition-opacity group-hover:opacity-100",children:(0,n.jsxs)(b.$,{onClick:()=>i(t),size:"sm",variant:"secondary",className:"h-[24px] gap-0.5 rounded-md border-none px-1.5 py-0.5 font-sans text-[13px] font-medium shadow-sm",children:["Ask ",(0,n.jsx)(eX.o,{className:"ml-0.5 h-3 w-3"})]})})]})}function e2(e){let{event:t,activeFilePath:l,setActiveFilePath:s}=e,r=i.useMemo(()=>{try{let e=JSON.parse(t.content);return"string"==typeof e?e:t.content}catch(e){return t.content}},[t.content]),{isCopied:c,copyToClipboard:d}=(0,g.C)({timeout:2e3}),u=async e=>{if(c)return;let t=(0,e1.z)(e);return await d(t),(0,o.u)("CopyOutputExecutable",{output:t})},m=()=>({stdout:"stdout"===t.method?[[r]]:[],stderr:"stderr"===t.method?[[r]]:[]});return(0,n.jsx)(a.ie,{fileName:t.fileName,isCopied:c,handleCopy:()=>void u(m()),handleDownload:()=>void(0,e1.X)(m()),handleFileOpen:()=>{l!==t.fileName&&(null==s||s(t.fileName))},children:"string"==typeof r?(0,n.jsx)("pre",{className:"whitespace-pre-wrap break-words",children:r}):(0,n.jsx)(a.Ip,{src:r,className:"[&_.jv-chevron]:ml-1 [&_.jv-chevron]:inline-block [&_.jv-chevron]:size-3 [&_.jv-chevron]:text-gray-500 [&_.jv-indent]:pl-4",style:"stderr"===t.method?{color:"rgb(192,27,93)"}:void 0})})}function e3(e){let{consoleEvents:t,clearLogs:l,canWriteToChat:i,hideHeader:s,className:r,activeFilePath:o,setActiveFilePath:c}=e,{setPromptFormInput:d}=(0,eY.Q1)(),u=(0,ej.oQ)(),{containerRef:m,vlistRef:p,handleScroll:h,scrollDownButton:x}=(0,e0.I)({count:t.length,pushToBottom:!0}),v=e=>{d("The code has the following ".concat(e.method,":\n```\n").concat("console"===e.type?e.message:e.content,"\n```\nRevise the code to address this issue.")),(0,eq.Ny)()&&u(!1)};return(0,n.jsxs)("div",{className:(0,f.cn)("bg-muted flex size-full flex-col items-stretch overflow-hidden",r),children:[!s&&(0,n.jsxs)(eH.o,{className:"justify-between gap-1",bottomBorder:!0,children:[(0,n.jsx)("h3",{className:"text-[13px] font-medium",children:"Console"}),(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,n.jsxs)("div",{className:"text-xs",children:[(0,n.jsxs)("span",{children:[t.length," "]}),(0,n.jsx)("span",{children:1===t.length?"event":"events"})]}),(0,n.jsx)("div",{className:"ml-1 h-[16px] w-[1px] bg-gray-200","aria-hidden":!0}),(0,n.jsx)(b.$,{variant:"ghost",size:"xs",className:"text-gray-500",tooltip:"Clear console output",onClick:l,disabled:0===t.length,children:(0,n.jsx)(S,{})})]})]}),(0,n.jsxs)("div",{className:"relative size-full",style:{contain:"strict"},children:[(0,n.jsx)("div",{className:"h-full w-full overflow-y-auto",ref:m,style:{overflowAnchor:"none"},children:(0,n.jsx)("div",{className:"mx-auto w-full",children:0===t.length?(0,n.jsx)("div",{className:"flex h-full items-center justify-center p-8",children:(0,n.jsx)("div",{className:"text-center text-sm text-gray-500",children:"No logs available to display"})}):(0,n.jsx)(eJ.YV,{scrollRef:m,ref:p,onScroll:h,children:t.map((e,t)=>(0,n.jsx)("div",{className:(0,f.cn)("group relative flex min-h-[24px] items-center",(0,a.eD)(e.method)),children:"console"===e.type?(0,n.jsx)(e5,{event:e,canWriteToChat:i,onAskV0:v}):(0,n.jsx)(e2,{event:e,activeFilePath:o,setActiveFilePath:c})},"".concat(e.timestamp,"-").concat(t)))})})}),t.length>0?(0,n.jsx)("div",{className:"sticky inset-x-0 bottom-2 z-50 flex justify-center",children:x}):null]})]})}var e4=l(71857);let e9=e=>{let{className:t,dotColor:l}=e;return(0,n.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:t,children:[(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16 5.64582V12.5C16 13.8807 14.8807 15 13.5 15H2.5C1.11929 15 0 13.8807 0 12.5V2.5V1H1.5H9.53513C9.27389 1.45161 9.0984 1.95903 9.03095 2.5H1.5V12.5C1.5 13.0523 1.94772 13.5 2.5 13.5H13.5C14.0523 13.5 14.5 13.0523 14.5 12.5V6.70924C15.08 6.47444 15.5925 6.10753 16 5.64582ZM4.44194 10.6919L4 11.1339L3.11612 10.25L3.55806 9.80806L5.36612 8L3.55806 6.19194L3.11612 5.75L4 4.86612L4.44194 5.30806L6.51517 7.38128C6.85687 7.72299 6.85687 8.27701 6.51516 8.61872L4.44194 10.6919ZM8.6225 9.75494H8V10.9999H8.6225H11.75H12.3725V9.75494H11.75H8.6225Z",className:"fill-current"}),(0,n.jsx)("circle",{cx:"13",cy:"3",r:"3",fill:l})]})};function e7(e){let{status:t,isExpanded:l}=e;return!t||l?(0,n.jsx)(e4.b,{}):(0,n.jsx)(e9,{className:"text-gray-500 transition-colors group-hover/log-panel-header:text-gray-900",dotColor:"error"===t?"#DC2626":"#2563EB"})}let e6=(e,t)=>e/t*100,e8=(e,t)=>e/100*t,te=e=>e>N.Tq;function tt(e){let{children:t,blockId:l,consoleEvents:s=[],clearLogs:a,canWriteToChat:r,activeFilePath:o,setActiveFilePath:c,initialSize:d,initialExpanded:m,onShouldExpand:p}=e,[h,v]=(0,i.useState)(""),{blockStatus:g,clearEvents:j}=eV(l),y=g[l],w=(0,i.useRef)(null),[k,P]=(0,i.useState)(null!=m?m:N.XK),E=(0,i.useRef)(null),C=(0,i.useMemo)(()=>{if(!h)return s;let e=h.toLowerCase();return s.filter(t=>"console"===t.type?t.message.toLowerCase().includes(e):t.content.toLowerCase().includes(e))},[s,h]),R=(0,i.useCallback)(()=>{var e,t,l,n,i,s,a;let r=null===(e=w.current)||void 0===e?void 0:e.getContainer(),o=null==r?void 0:null===(t=r.parentElement)||void 0===t?void 0:t.clientHeight;if(!o)return;let c=e6(N.as,o),d=null!==(n=null===(l=w.current)||void 0===l?void 0:l.getSize())&&void 0!==n?n:0;if(k)d>c&&(E.current=d),null===(i=w.current)||void 0===i||i.setSize(c),u.A.set(N.Mo,String(c),{expires:7}),u.A.set(N.jL,String(!1),{expires:7});else{let e=null!==(a=E.current)&&void 0!==a?a:N.uq;null===(s=w.current)||void 0===s||s.setSize(e),u.A.set(N.Mo,String(e),{expires:7}),u.A.set(N.jL,String(!0),{expires:7})}P(!k),j()},[k,j]);(0,i.useEffect)(()=>{p&&!k&&p(R)},[p,R,k]);let T=(0,i.useCallback)(e=>{var t,l,n;let i=null===(t=w.current)||void 0===t?void 0:t.getContainer(),s=te(e8(e,null!==(n=null==i?void 0:null===(l=i.parentElement)||void 0===l?void 0:l.clientHeight)&&void 0!==n?n:0));s&&(E.current=null),k!==s&&(P(s),u.A.set(N.jL,String(s),{expires:7}),j())},[j,k]),U=(0,O.k)("logPanel");return(0,n.jsxs)("div",{className:"relative flex size-full min-h-0 flex-1 flex-col",children:[t,(0,n.jsx)(x,{animated:!1,axis:"y",cookieName:N.Mo,dotsHandle:!1,initialSize:null!=d?d:N.H2,minSizePx:N.as,minNegativeSpace:144,show:!0,side:"start",snapTo:{threshold:N.Tq,size:N.as},onResize:T,className:"z-20",ref:w,children:(0,n.jsxs)("div",{className:"bg-muted group/log-panel-header relative flex size-full flex-col border-t",children:[(0,n.jsxs)("div",{className:"border-alpha-400 flex h-9 w-full shrink-0 cursor-pointer items-center justify-between border-b hover:text-gray-900",onClick:R,children:[(0,n.jsxs)("div",{className:(0,f.cn)("flex items-center gap-1.5 px-3 text-sm text-gray-500 transition-all group-hover/log-panel-header:text-gray-900",k&&"text-gray-900"),children:[(0,n.jsx)(e7,{status:y,isExpanded:k}),(0,n.jsx)("span",{children:U("console")})]}),(0,n.jsxs)("div",{className:"flex gap-0.5 pr-2",children:[k?(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(ev.p,{placeholder:"Filter...",size:"xs",className:"w-44 rounded-md px-2 text-[13px]",value:h,onChange:e=>v(e.target.value),onClick:e=>e.stopPropagation()}),(0,n.jsx)(b.$,{variant:"ghost",size:"xs",className:"text-gray-500",tooltip:{side:"bottom",content:"Clear logs"},onClick:e=>{e.stopPropagation(),null==a||a()},disabled:0===s.length,children:(0,n.jsx)(S,{})})]}):null,(0,n.jsx)(b.$,{tooltip:{side:"bottom",content:k?"Collapse panel":"Expand panel"},variant:"ghost",className:"text-gray-500",size:"xs",onClick:e=>{e.stopPropagation(),R()},children:k?(0,n.jsx)(e$.r,{}):(0,n.jsx)(eK.U,{})})]})]}),(0,n.jsx)(e3,{hideHeader:!0,consoleEvents:C,clearLogs:a||(()=>{}),canWriteToChat:r,className:"bg-transparent",activeFilePath:o,setActiveFilePath:c})]})})]})}var tl=l(9097),tn=l(68971);let ti=(0,G.default)(()=>Promise.all([l.e(28),l.e(3155)]).then(l.bind(l,83155)).then(e=>e.MultiFileLocalCodeBlock),{loadableGenerated:{webpack:()=>[83155]}}),ts=Z()((e,t,l)=>{if(e){var n;null===(n=e.contentWindow)||void 0===n||n.postMessage({type:"preview_code",code:t,version:l},"*")}},300);function ta(e){let{children:t,activeTab:l,setActiveTab:s,allowRefresh:a,allowFullScreen:r=!0,initialFileTreeSize:o,resultId:d,language:u,remoteInfo:m,meta:f,source:h,hasBlockPreview:x,blockId:v,blockType:g,closed:b,hasSourceBeenEdited:y,onEdit:w,files:k,loadingPath:N,originalCode:E,isV3:C,initialConsoleSize:S,initialConsoleExpanded:_}=e,{activeFilePath:D,setActiveFilePath:F,setAutoSwitch:V}=(0,eD.m)({blockId:v,files:k,loadingPath:N}),{setHref:W,latestHref:Z}=(0,tn.Z)(v),{editValueMap:G,setEditValueMap:$}=(0,ez.V)({blockId:v}),[K,Q]=(0,i.useState)(null),{flagNewEvent:X}=eV(v),[q,et]=(0,i.useState)([]),el=(0,i.useCallback)(()=>{et([])},[]),en=(0,i.useCallback)(e=>{et(t=>[...t,e]),"console"!==l&&("message"in e&&e.message.includes("[Fast Refresh]")||("error"===e.method||"stderr"===e.method?X("error"):X("log")))},[l,X]),ei=(0,i.useCallback)(e=>{et(t=>[...t,...e]),e.some(e=>"stderr"===e.method)?"console"!==l&&X("error"):"console"!==l&&X("log")},[l,X]);(0,i.useEffect)(()=>{el()},[v,el]);let es=(0,p.aq)(),{isPublished:ea}=(0,P.usePublishedPage)(),{canWriteToChat:er}=(0,eW.tZ)(),eo=(0,O.k)("previewBlock"),{data:ec,mutate:ed}=(0,c.Ay)(v?["remote:accepted",v]:null,null,{fallbackData:null==m?void 0:m.accepted}),eu=(0,eF.F)(G),em=(0,eF.F)(k),ef=(0,i.useCallback)((e,t,l)=>{if(!b)return;let n={...eu.current,[t]:e};$(n),null==w||w(e);let i=(0,I.j)(null!=d?d:v),s=document.getElementById(i);if(s){if("code-project"===g)ts(s,(0,Y.F7)((0,Y.GP)(n,em.current||[])),l);else if("v0"===g)ts(s,e);else{var a;null===(a=s.contentWindow)||void 0===a||a.postMessage({type:u.toUpperCase()+"_RENDER",source:e},s.dataset.origin||"")}}},[b,eu,$,w,d,v,g,em,u]);(0,i.useEffect)(()=>{let e=(0,I.j)(null!=d?d:v),t=document.getElementById(e);if(!t)return;let l=e=>{var l,n;if(e.data&&"object"==typeof e.data&&e.data.__v0_remote__)switch(e.data.type){case"frame_ready":if("code-project"===g){if(!(null===(l=em.current)||void 0===l?void 0:l.length))return;Object.keys(eu.current).length>0&&ts(t,(0,Y.F7)((0,Y.GP)(eu.current,em.current)))}break;case"inline_edit":if(!em.current)return;let i=em.current.findIndex(t=>t.meta.file===e.data.file);if(-1===i)return;let s=null!==(n=eu.current[e.data.file])&&void 0!==n?n:em.current[i].source,a=s.split("\n"),r=a[e.data.line-1],o=r.substring(0,e.data.column-1),c=r.substring(e.data.column-1+e.data.len),d=e.data.replace;a[e.data.line-1]=o+d+c,ef(s=a.join("\n"),e.data.file,e.data.version);break;case"console":en(e.data)}};return window.addEventListener("message",l),()=>{window.removeEventListener("message",l)}},[v,g,d,em,ef,eu,en]),(0,i.useEffect)(()=>{let e=(0,I.j)(null!=d?d:v);if(!document.getElementById(e))return;let t=e=>{e.data&&"object"==typeof e.data&&e.data.__v0_remote__&&"location_change"===e.data.type&&W(e.data.href)};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}},[v,d,W]);let ep=k||[{source:h,meta:f,originalCode:E,lang:u,isQuickEdit:!!f.isQuickEdit,blockId:v}],eh=(0,i.useCallback)(()=>{$({})},[$]),{user:ex}=(0,eG.J)(),ev=(0,ee.z)({blockId:v,editValueMap:G,isAdminSaving:!er&&!!(null==ex?void 0:ex.isAdminMode),source:h,meta:f,files:ep,clearEditValueMap:eh}),[,eg]=eB(v),eb=ev.hasUnsavedChanges;(0,i.useEffect)(()=>{eg(eb)},[eb,eg]);let ej=!!(b&&er)||!!(null==ex?void 0:ex.isAdminMode);if(ea)return(0,n.jsx)("div",{className:(0,U.A)("bg-muted h-full min-h-0 overflow-hidden","preview"===l&&"border-alpha-200",!es&&"opacity-0"),children:t});if("code-project"===g){if(!o)throw Error("code-project block is missing initialFileTreeSize");let e=ep.length?ep.find(e=>e.meta.file===D)||ep[0]:void 0,s=e?[{key:"preview",content:!0===x?(0,n.jsxs)("div",{className:"flex h-full w-full flex-col",children:[(r||a)&&(0,n.jsxs)(eH.o,{className:"bg-muted justify-end gap-1",bottomBorder:!0,children:[r?(0,n.jsx)(H,{}):null,a?(0,n.jsx)(z,{blockId:d||v}):null]}),(0,n.jsx)("div",{className:"w-full flex-1 overflow-auto",children:(0,n.jsx)(B.FullscreenContainer,{children:t})})]}):"object"==typeof x&&"warning"in x?(0,n.jsx)("div",{className:"flex h-full w-full items-center justify-center gap-2",children:x.warning}):null},C?null:{key:"code",content:(0,n.jsx)(eO,{showDiffInfo:b,loadingPath:N,activeFilePath:D,setActiveFile:e=>{V&&V(!1),F(e)},initialFileTreeSize:o,files:k,source:h,blockId:v,onChange:()=>{let e=(0,I.j)(null!=d?d:v),t=document.getElementById(e);t&&(t.contentDocument?t.contentDocument.location.reload():Z.current?t.src=Z.current:t.src=t.src)},children:(0,n.jsxs)("div",{className:"flex h-full w-full flex-col",children:[(0,n.jsxs)(eH.o,{className:"justify-between gap-2",onePixelShorter:!0,children:[(0,n.jsx)("div",{className:"flex min-w-0 items-center gap-1 overflow-x-auto",children:D&&D.split("/").map((e,t)=>(0,n.jsxs)(i.Fragment,{children:[(0,n.jsx)("div",{className:"whitespace-nowrap font-medium [&:nth-last-child(2)]:text-gray-900",children:e},"part-".concat(e,"-").concat(t)),(0,n.jsx)("div",{className:"last:hidden",children:(0,n.jsx)(L.b,{})},"chevron-".concat(e,"-").concat(t))]},"part-".concat(e,"-").concat(t)))}),(0,n.jsx)("div",{className:"flex items-center gap-1",children:(0,n.jsx)(T.C,{closed:b,additionalHeaderActions:void 0,allowClose:!1,blockId:v,allowCopyCode:!0,allowDownloadCode:!0,originalCode:e.originalCode,caller:"v0",closeHandler:null,fileName:e.meta.file,isTabbed:!0,value:G[f.file||""]||e.source,isExecutable:"script"===e.meta.type&&"code"===l,transactionMeta:e.meta.transaction,language:e.lang,onExecutionComplete:e=>{ei(e),null==K||K()}})})]}),(0,n.jsx)("div",{className:"w-full flex-1 overflow-auto",children:(0,n.jsx)(tr,{blockType:g,remoteInfo:m,isMultiFile:!0,closed:b,blockId:v,setEditValueMap:$,language:e.lang,editValueMap:G,hasSourceBeenEdited:y,handleEdit:ef,file:e,editable:ej,appendCodeOutputEvents:ei})})]})})}].filter(tl.R):[];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tt,{blockId:v,consoleEvents:q,clearLogs:el,canWriteToChat:er,activeFilePath:D,setActiveFilePath:F,initialSize:S,initialExpanded:_,onShouldExpand:e=>Q(()=>e),children:(0,n.jsxs)("div",{className:"relative min-h-0 w-full flex-1 grow",children:[(0,n.jsx)(R.JS,{className:(0,U.A)(C?"":"border-alpha-200 border-t"),tabFiles:s,activeTabKey:l}),ej?(0,n.jsx)(ee.o,{...ev,resetValue:()=>{let e=(0,I.j)(null!=d?d:v),t=document.getElementById(e);t&&ts(t,(0,Y.F7)((0,Y.GP)({},em.current||[])))},mergedFromBlockId:v,isV3:C}):null]})}),(0,n.jsx)(R.JS,{className:C?"":"border-alpha-200 border-t",tabFiles:s,activeTabKey:l})]})}let ey=ep.map(e=>({key:void 0!==k?f.file+"code":"code",display:f.file||"Untitled",content:(0,n.jsx)(tr,{blockType:g,remoteInfo:m,closed:b,blockId:v,setEditValueMap:$,language:u,editValueMap:G,hasSourceBeenEdited:y,handleEdit:ef,file:e,editable:ej,appendCodeOutputEvents:ei}),actions:(0,n.jsx)(T.C,{closed:b,additionalHeaderActions:void 0,allowClose:!1,blockId:v,allowCopyCode:!0,allowDownloadCode:!0,originalCode:e.originalCode,caller:"v0",closeHandler:null,fileName:e.meta.file,isTabbed:!0,value:G[f.file||""]||e.source})})),ew={key:"preview",disabled:!(0,eZ.O)(x),tooltip:"object"==typeof x&&"error"in x?x.error:b?void 0:eo("previewIsStreaming"),display:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(M.p,{className:"group-disabled:hidden"}),(0,n.jsx)("div",{className:"hidden group-disabled:block",children:b?(0,n.jsx)(A.X,{}):(0,n.jsx)(j.y,{size:16})}),eo("preview")]}),content:(0,n.jsx)(B.FullscreenContainer,{children:t}),actions:(0,n.jsxs)(n.Fragment,{children:[r?(0,n.jsx)(H,{}):null,a?(0,n.jsx)(z,{blockId:d||v}):null]})};return(0,n.jsxs)(n.Fragment,{children:["local"!==g||"@remote"===v||k?null:(0,n.jsx)(J,{blockId:v,hasUnappliedChanges:!!(!0!==ec||G[f.file||""]&&G[f.file||""]!==h),source:G[f.file||""]||h,onApply:()=>{ed(!0)},showFadeOut:"code"===l}),ej?(0,n.jsx)(ee.o,{...ev,resetValue:()=>{let e=(0,I.j)(null!=d?d:v),t=document.getElementById(e);if(t){if("v0"===g)ts(t,ep[0].source);else{var l;null===(l=t.contentWindow)||void 0===l||l.postMessage({type:u.toUpperCase()+"_RENDER",source:ep[0].source},t.dataset.origin||"")}}},mergedFromBlockId:v,isV3:C}):null,(0,n.jsx)(R.Yv,{activeTabKey:l||"code",isLoading:!b,setActiveTabKey:s,tabFiles:[ew,...ey]})]})}function tr(e){let{blockType:t,remoteInfo:l,closed:a,blockId:r,setEditValueMap:o,isMultiFile:c,language:d,editValueMap:u,hasSourceBeenEdited:m,handleEdit:f,file:p,editable:h,className:x,appendCodeOutputEvents:v}=e,{source:g,meta:b,originalCode:j,isQuickEdit:y}=p;return"local"===t?(0,n.jsx)(i.Suspense,{fallback:null,children:(0,n.jsx)(ti,{remoteInfo:l,blockId:r,source:g,onEdit:e=>{a&&o(t=>({...t||{},[b.file||""]:e}))},closed:a})}):p.meta.url&&!p.source.trim().length?(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)(tc,{url:p.meta.url,file:p.meta.file})}):(0,n.jsx)(s.N,{isMultiFile:c,allowQuoting:!0,closed:a,caller:"v0",originalCode:j,showQuickEditAnimation:!a&&y,className:(0,U.A)("not-prose flex-1 grow",x),editable:h,fixingBadLines:p.fixingBadLines,fileName:b.file,language:d,blockId:r,editValue:u[b.file||""],hasSourceBeenEdited:m,onEdit:e=>f(e,b.file||""),runnable:!0,showLineNumbers:!0,value:g,type:b.type,onExecutionComplete:v})}let to=(e,t)=>{var l;if(t)return t;let n=(null===(l=e.split(".").pop())||void 0===l?void 0:l.toLowerCase())||"";return["jpg","jpeg","png","gif","svg","webp","avif"].includes(n)?"image":["glb","gltf"].includes(n)?"3d":["mp3","wav","ogg","flac"].includes(n)?"audio":["mp4","webm","ogv"].includes(n)?"video":"pdf"===n?"pdf":"unknown"};function tc(e){let{url:t,mimeType:l,file:s}=e,[a,r]=(0,i.useState)(null),o=to(t,l);(0,i.useEffect)(()=>{r(null)},[t]);let c=()=>{r("Failed to load ".concat(o," from ").concat(t))};if(a)return(0,n.jsx)("div",{className:"rounded border border-red-300 bg-red-50 p-4 text-red-500",children:a});switch(o){case"image":return(0,n.jsx)("img",{src:t||"/placeholder.svg",className:"h-auto max-w-full",onError:c,alt:"Preview of ".concat(s)});case"3d":return(0,n.jsx)("div",{className:"h-[400px] w-full",children:"Previewing 3D models is not currently supported."});case"audio":return(0,n.jsxs)("audio",{controls:!0,className:"w-full",onError:c,children:[(0,n.jsx)("source",{src:t}),"Your browser does not support the audio element."]});case"video":return(0,n.jsxs)("video",{controls:!0,className:"h-auto max-w-full",onError:c,children:[(0,n.jsx)("source",{src:t}),"Your browser does not support the video element."]});case"pdf":return(0,n.jsxs)("div",{className:"rounded border bg-gray-50 p-4",children:[(0,n.jsxs)("p",{className:"mb-2",children:["PDF document:"," ",(0,n.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Open PDF"})]}),(0,n.jsx)("iframe",{src:"".concat(t,"#view=FitH"),className:"h-[500px] w-full",onError:c})]});default:return(0,n.jsx)("div",{className:"rounded border bg-gray-50 p-4",children:(0,n.jsxs)("p",{children:["Unknown file type."," ",(0,n.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Download file"})]})})}}var td=l(18730),tu=l(75719);async function tm(e){let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch outdated env vars");return t.json()}async function tf(e){if(!(await fetch(e,{method:"POST"})).ok)throw Error("Failed to sync env vars")}var tp=l(18867);function th(){let[e,t]=(0,i.useState)(!0),{isAuthor:l}=(0,td.Pk)(),{project:s}=(0,eW.tZ)(),a=(0,ej.eu)(),{outdatedEnvVars:r,sync:o,syncError:d}=function(e,t){let{data:l,error:n,isLoading:i,mutate:s}=(0,c.Ay)(e&&t?"/chat/api/chat/env-vars/outdated?bid=".concat(e):null,tm,{refreshInterval:18e4}),{trigger:a,error:r}=(0,tu.A)(e&&t?"/chat/api/chat/env-vars/outdated?bid=".concat(e):null,tf),o=async()=>{await a(),await s()};return{outdatedEnvVars:l,isLoading:i,error:n,refresh:s,sync:o,syncError:r}}(null==a?void 0:a.id,null==s?void 0:s.vercelProjectId),[u,m]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{d&&(console.error("Failed to sync environment variables",d),$.oR.error("Failed to sync environment variables",{position:"bottom-right"}))},[d]),e&&(null==r?void 0:r.length))?(0,n.jsx)("div",{className:"shadow-modal bg-background absolute bottom-2 right-2 z-10 max-w-[350px] rounded p-2",children:(0,n.jsxs)("div",{className:" flex min-w-[300px] flex-col items-center gap-3 rounded-[8px]   p-2 text-sm",role:"alert",children:[(0,n.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,n.jsxs)("div",{className:"flex w-full items-center font-semibold",children:[(0,n.jsx)("span",{children:"Outdated Environment Variables"})," "]}),(0,n.jsx)("div",{className:"flex w-full",children:(0,n.jsx)("span",{className:"font-small line-clamp-3 overflow-hidden text-xs",children:"The connected v0 Project has environment variables not in sync with the current block. Sync them to ensure your block works as expected."})})]}),l&&(0,n.jsxs)("div",{className:"flex w-full justify-end gap-2 align-middle",children:[(0,n.jsx)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",size:"sm",variant:"ghost",onClick:()=>{t(!1)},children:"Dismiss"}),(0,n.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",size:"sm",variant:"secondary",onClick:async()=>{m(!0),await o(),m(!1),t(!1),$.oR.success("Environment variables synced",{position:"bottom-right"})},disabled:u,children:[(0,n.jsx)(tp.j,{height:13,width:13})," Sync"]})]})]})}):null}class tx{static Render(e){var t;let{isPublished:l}=(0,P.usePublishedPage)(),u=(0,p.aq)(),{isCopied:m,copyToClipboard:h}=(0,g.C)({timeout:2e3}),{editValueMap:b,setEditValueMap:j}=(0,ez.V)({blockId:e.blockId}),{isAuthor:y}=(0,td.Pk)(),{data:U,mutate:I}=(0,c.Ay)(["block:output",e.blockId]),{data:L}=(0,c.Ay)("block:output:initial");(0,i.useEffect)(()=>{(null==L?void 0:L.id)===e.blockId&&L.result.then(e=>{e&&I(t=>t||e.value)})},[L,e.blockId,I]);let A=U;if(void 0===A&&(null==L?void 0:L.id)===e.blockId&&L){let e=(0,i.use)(L.result);e&&(A=e.value)}let M=async()=>{if(m)return;let e=(0,e1.z)(A);return await h(e),(0,o.u)("CopyOutputExecutable",{output:e})},_=(0,i.useMemo)(()=>k.DS.includes(e.language)&&k._b.some(t=>{var l;return null===(l=e.meta.file)||void 0===l?void 0:l.endsWith(t)}),[e.language,e.meta.file]),O=(0,ee.z)({blockId:e.blockId,editValueMap:b,source:e.source,meta:e.meta,files:[{source:e.source,meta:e.meta}],clearEditValueMap:()=>j({})}),D=l?N.Lk:N.K4,z=[{key:"code",display:e.meta.file,content:(0,n.jsxs)(n.Fragment,{children:[e.closed&&y?(0,n.jsx)(ee.o,{...O,resetValue:()=>{},mergedFromBlockId:e.blockId}):null,(0,n.jsx)(tr,{blockType:e.meta.type,remoteInfo:void 0,isMultiFile:!0,closed:e.closed,blockId:e.blockId,className:O.hasUnsavedChanges?"pb-14":"",setEditValueMap:j,language:e.language,editValueMap:b,hasSourceBeenEdited:e.hasSourceBeenEdited,handleEdit:t=>{t&&e.closed&&j(l=>({...l,[e.meta.file||""]:t}))},file:{source:e.source,meta:e.meta,lang:e.language,blockId:e.blockId,isQuickEdit:!!e.meta.isQuickEdit},editable:e.closed&&y},e.blockId)]}),actions:(0,n.jsx)(T.C,{additionalHeaderActions:void 0,allowClose:!1,allowCopyCode:!0,allowDownloadCode:!0,caller:"v0",closeHandler:null,fileName:e.meta.file,isTabbed:!0,value:b[e.meta.file||""]||e.source,originalCode:e.originalCode,blockId:e.blockId,closed:e.closed,language:e.language})}],F=l?(0,n.jsx)(s.N,{originalCode:e.originalCode,showQuickEditAnimation:!e.closed&&!!e.meta.isQuickEdit,closed:e.closed,blockId:e.blockId,allowQuoting:!0,caller:"executable",className:"min-h-52 flex-1 rounded-md",editable:!1,fileName:e.meta.file,language:e.language,runnable:_,showLineNumbers:!0,value:e.source}):(0,n.jsx)(R.Yv,{isLoading:!e.closed,activeTabKey:"code",className:"min-h-52 w-full flex-1",setActiveTabKey:()=>{},tabFiles:z});return(0,n.jsxs)("div",{className:(0,f.cn)("not-prose flex h-full w-full flex-col",l&&"bg-muted overflow-hidden rounded-md border",!u&&"opacity-0"),children:[F,_&&(0,n.jsx)(x,{animated:!1,axis:"y",cookieName:D,dotsHandle:!1,initialSize:null!==(t=e.initialOutputSize)&&void 0!==t?t:33,minSizePx:200,show:!0,side:"start",children:(0,n.jsx)("div",{className:"border-alpha-400 flex size-full min-h-0 flex-1 flex-col items-center justify-center border-t",children:A?(0,n.jsxs)("div",{className:"flex size-full flex-col items-stretch",children:[(0,n.jsxs)("div",{className:(0,f.cn)("flex items-center justify-between border-b px-2 py-1"),children:[(0,n.jsx)("h3",{className:"select-none text-sm font-medium text-gray-500",children:"Output"}),(0,n.jsxs)("div",{className:"flex select-none items-center gap-1",children:[(0,n.jsx)(w,{buttonText:"Run",codeExecutionBlockProps:e,editedValue:b[e.meta.file||""]||void 0,execute:r.M,setOutput:I,variant:"ghost"}),(0,n.jsx)("div",{className:"bg-alpha-400 h-4 w-px"}),(0,n.jsx)(v.Z,{"aria-label":"Clear",onClick:()=>I(void 0),tooltip:"Clear",children:(0,n.jsx)("span",{"aria-hidden":!0,children:(0,n.jsx)(S,{})})}),(0,n.jsx)(v.Z,{"aria-label":"Download",disabled:"error"in A,onClick:()=>(0,e1.X)(A),tooltip:"Download",children:(0,n.jsx)("span",{"aria-hidden":!0,children:(0,n.jsx)(E.q,{})})}),(0,n.jsx)(v.Z,{disabled:"error"in A,onClick:M,tooltip:"Copy",children:(0,n.jsx)("span",{"aria-hidden":!0,children:m?(0,n.jsx)(d.J,{}):(0,n.jsx)(C.T,{})})})]})]}),(0,n.jsx)(a.X3,{className:"h-full",value:A})]}):(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("p",{className:"mb-2 text-base font-medium text-gray-900",children:"No Output"}),(0,n.jsx)("p",{className:"mb-6 text-sm text-gray-500",children:e.closed?"Run the code to generate an output.":"You can execute the code after it has finished streaming."}),(0,n.jsx)(w,{codeExecutionBlockProps:e,disabled:!e.closed,editedValue:b[e.meta.file||""]||void 0,execute:r.M,setOutput:I})]})})}),_&&y&&!l&&(0,n.jsx)(th,{})]})}static Actions(e){return null}}tx.getIsPreviewable=()=>!1,tx.TitleActions=null;let tv=new WeakMap,tg=new WeakSet,tb=new WeakMap;function tj(e){let t=e.replace(/_/g,"--").replace(/[^a-zA-Z0-9-]/g,"").replace(/-+$/,"");if("generated.vusercontent.net".endsWith(".vercel.sh")){let e="generated.vusercontent.net".split(".")[0].replace(/^v0-frame-/g,"");return ty("".concat(e,"--").concat(t,".dev.vusercontent.net"))}return ty("g-".concat(t,".vusercontent.net"))}function ty(e){let t=new URL("https://example.com");return t.hostname=e,t.origin}function tw(e,t){if(!e)return;let l=tv.get(e);l?l.push(t):tv.set(e,[t]),tk(e)}function tk(e){if(!tg.has(e))return;let t=tv.get(e);if(t){for(let n of t){var l;null===(l=e.contentWindow)||void 0===l||l.postMessage(n,e.dataset.origin||"")}t.length=0}}let tN=[];window.addEventListener("message",e=>{if(!(e.origin===tj("any")||e.origin.endsWith(".vusercontent.net"))||!e.source)return;let t=Array.from(document.querySelectorAll("iframe[data-v0]")).find(t=>t instanceof HTMLIFrameElement&&t.contentWindow===e.source);if(!t)return;tg.add(t),tk(t),window.debug&&console.log("child event handler",e.data);let l=tb.get(t);for(let t of tN)l===t.id&&t.listener(e.data)});var tP=l(20172);let tE={LIGHTNING_WEB_COMPONENTS_UNSUPPORTED:"v0 does not currently support previewing LWC",LAYOUT_UNSUPPORTED:"v0 cannot currently preview Next.js layouts",SERVER_ACTION_UNSUPPORTED:"Server Actions cannot be previewed",RSC_UNSUPPORTED:"v0 cannot currently preview React Server Components",API_KEY_UNSUPPORTED:"v0 cannot currently preview components with API keys",REACT_NATIVE_UNSUPPORTED:"v0 cannot currently preview React Native components",ELECTRON_UNSUPPORTED:"v0 cannot currently preview Electron apps",EXPO_UNSUPPORTED:"v0 cannot currently preview Expo components",CLERK_UNSUPPORTED:"v0 does not currently support previewing Clerk",PRISMA_UNSUPPORTED:"v0 does not currently support previewing @prisma/client",NEXT_INTL_UNSUPPORTED:"v0 does not currently support previewing next-intl",NODEMAILER_UNSUPPORTED:"v0 does not currently support previewing nodemailer",INERTIA_UNSUPPORTED:"v0 does not currently support previewing Inertia.js",EXPRESS_UNSUPPORTED:"v0 does not currently support previewing Express.js",FS_NOT_SUPPORTED:"v0 does not currently support previews with file system access",REMIX_UNSUPPORTED:"v0 does not currently support previewing Remix",REACT_ROUTER_UNSUPPORTED:"v0 does not currently support previewing react-router",MONGODB_UNSUPPORTED:"v0 does not currently support previewing MongoDB",ROUTE_HANDLER_UNSUPPORTED:"v0 cannot preview Route Handlers",REACT_HOOKS:"React hooks cannot be previewed",NON_JS_TS_FILE_UNSUPPORTED:"v0 can not preview this file",TEST_FILES_UNSUPPORTED:"v0 does not currently support previewing tests",NODE_APIS:"v0 does not currently support previewing Node.js APIs",CHAKRA_UNSUPPORTED:"v0 does not currently support previewing Chakra UI",REACT_PDF_UNSUPPORTED:"v0 does not currently support previewing @react-pdf/renderer",SWIPER_UNSUPPORTED:"v0 does not currently support previewing swiper/css",SENDGRID_UNSUPPORTED:"v0 does not currently support previewing @sendgrid/mail",GOOGLEAPIS_UNSUPPORTED:"v0 does not currently support previewing code using googleapis",ANGULAR_UNSUPPORTED:"v0 does not currently support previewing Angular",MATERIAL_UI_ADAPTER_DATE_UNSUPPORTED:"v0 does not currently support previewing @mui/x-date-pickers/AdapterDateFns",PLAYWRIGHT_UNSUPPORTED:"v0 does not currently support previewing Playwright",INSTRUMENTATION_UNSUPPORTED:"v0 does not support previewing instrumentation.ts",LARAVEL_UNSUPPORTED:"v0 does not currently support previewing Laravel",MONGOOSE_UNSUPPORTED:"v0 does not currently support previewing Mongoose"},tC=[["@clerk/nextjs",tE.CLERK_UNSUPPORTED],["@clerk/clerk-react",tE.CLERK_UNSUPPORTED],["next-intl",tE.NEXT_INTL_UNSUPPORTED],["react-native",tE.REACT_NATIVE_UNSUPPORTED],["@prisma/client",tE.PRISMA_UNSUPPORTED],["nodemailer",tE.NODEMAILER_UNSUPPORTED],["@sendgrid/mail",tE.SENDGRID_UNSUPPORTED],["@inertiajs/react",tE.INERTIA_UNSUPPORTED],["@chakra-ui/react",tE.CHAKRA_UNSUPPORTED],["@react-pdf/renderer",tE.REACT_PDF_UNSUPPORTED],["swiper/css",tE.SWIPER_UNSUPPORTED],["swiper/css/navigation",tE.SWIPER_UNSUPPORTED],["@playwright/test",tE.PLAYWRIGHT_UNSUPPORTED],["angular/router",tE.ANGULAR_UNSUPPORTED],["angular/core",tE.ANGULAR_UNSUPPORTED],["@angular/router",tE.ANGULAR_UNSUPPORTED],["@angular/core",tE.ANGULAR_UNSUPPORTED],["@angular/common",tE.ANGULAR_UNSUPPORTED],["@mui/x-date-pickers/AdapterDateFns",tE.MATERIAL_UI_ADAPTER_DATE_UNSUPPORTED],["@react-navigation/native",tE.EXPO_UNSUPPORTED],["@react-navigation/stack",tE.EXPO_UNSUPPORTED],["expo-router",tE.EXPO_UNSUPPORTED],["express",tE.EXPRESS_UNSUPPORTED],["expo-file-system",tE.EXPO_UNSUPPORTED],["googleapis",tE.GOOGLEAPIS_UNSUPPORTED],["fs",tE.FS_NOT_SUPPORTED],["fs/promises",tE.FS_NOT_SUPPORTED],["bcrypt",tE.NODE_APIS],["@remix-run/node",tE.REMIX_UNSUPPORTED],["mongodb",tE.MONGODB_UNSUPPORTED],["react-router-dom",tE.REACT_ROUTER_UNSUPPORTED],["lwc",tE.LIGHTNING_WEB_COMPONENTS_UNSUPPORTED]],tS=["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"],tR=["tsx","html","jsx","js","ts"],tT={NON_SUPPORTED_FILES:"v0 can not preview this file",NO_EXPORTED_COMPONENT:"No exported component found"};function tU(e){return"v0 does not currently support ".concat(e)}let tI={"@clerk/nextjs/server":tE.CLERK_UNSUPPORTED,"@clerk/clerk-react":tE.CLERK_UNSUPPORTED,"next-intl":tE.NEXT_INTL_UNSUPPORTED,"react-native":tE.REACT_NATIVE_UNSUPPORTED,electron:tE.ELECTRON_UNSUPPORTED,nodemailer:tE.NODEMAILER_UNSUPPORTED,"@sendgrid/mail":tE.NODEMAILER_UNSUPPORTED,"@chakra-ui/react":tE.CHAKRA_UNSUPPORTED,lwc:tE.LIGHTNING_WEB_COMPONENTS_UNSUPPORTED,"@playwright/test":tE.PLAYWRIGHT_UNSUPPORTED,"angular/router":tE.ANGULAR_UNSUPPORTED,"angular/core":tE.ANGULAR_UNSUPPORTED,"@angular/router":tE.ANGULAR_UNSUPPORTED,"@angular/core":tE.ANGULAR_UNSUPPORTED,"@angular/common":tE.ANGULAR_UNSUPPORTED,"@mui/x-date-pickers/AdapterDateFns":tE.MATERIAL_UI_ADAPTER_DATE_UNSUPPORTED,"@react-navigation/native":tE.EXPO_UNSUPPORTED,"@react-navigation/stack":tE.EXPO_UNSUPPORTED,"expo-router":tE.EXPO_UNSUPPORTED,express:tE.EXPRESS_UNSUPPORTED,"expo-file-system":tE.EXPO_UNSUPPORTED,googleapis:tE.GOOGLEAPIS_UNSUPPORTED,"@remix-run/node":tE.REMIX_UNSUPPORTED,mongodb:tE.MONGODB_UNSUPPORTED,"react-router-dom":tE.REACT_ROUTER_UNSUPPORTED,"laravel-mix":tE.LARAVEL_UNSUPPORTED,mongoose:tE.MONGOOSE_UNSUPPORTED,"discord-player":tU("discord-player"),"fluent-ffmpeg":tU("fluent-ffmpeg"),"@prisma/client":tU("@prisma/client"),hono:tU("hono"),undici:tU("undici"),http2:tU("http2"),payload:tU("payload"),"@nestjs/mongoose":tU("@nestjs/mongoose"),"@nestjs/core":tU("@nestjs/core"),"@ionic/angular":tU("@ionic/angular"),"firebase-admin/database":tU("firebase-admin/database"),"firebase-admin":tU("firebase-admin"),"firebase-functions":tU("firebase-functions"),"puppeteer-core":tU("puppeteer-core"),"coffee-script":tU("coffee-script"),msw:tU("msw"),"msw/node":tU("msw/node"),mysql2:tU("mysql2"),"mysql2/promise":tU("mysql2"),"@worldcoin/idkit":tU("@worldcoin/idkit"),"discord.js":tU("discord.js"),"@vitejs/plugin-react":tU("Vite"),"vite-plugin-react":tU("Vite"),nativewind:tU("nativewind"),commander:tU("commander"),cosmiconfig:tU("cosmiconfig"),"react-native-svg":tU("react-native-svg"),"google-auth-library":tU("google-auth-library"),nextra:tU("nextra")},tL=Object.keys(tI).join("|"),tA=new RegExp("from ['\"](".concat(tL,")['\"]")),tM=new RegExp("import ['\"](".concat(tL,")['\"]")),t_=new RegExp("import\\(['\"](".concat(tL,")['\"]\\)")),tO=new RegExp("require\\(['\"](".concat(tL,")['\"]\\)")),tD={"@mui/utils":"v0 is currently investigating an issue with @mui/utils. We appreciate your patience."},tz=Object.keys(tD).join("|"),tF=new RegExp("from ['\"](".concat(tz,")['\"]")),tV=new RegExp("import ['\"](".concat(tz,")['\"]")),tH=new RegExp("import\\(['\"](".concat(tz,")['\"]\\)")),tB=new RegExp("require\\(['\"](".concat(tz,")['\"]\\)"));var tW=l(82399),tZ=l(44999);function tG(e){let{iframeId:t,iframeRef:l,activeTab:i,isPublished:s,src:a,origin:r,onLoad:o}=e,{publishBlockDialogOpen:c}=(0,tZ.ed)();return(0,n.jsx)("iframe",{allow:"fullscreen; camera; microphone; gyroscope; accelerometer; clipboard-write; autoplay",title:"v0 block",className:(0,U.A)("h-full w-full select-none","preview"!==i&&(s?"hidden":"sr-only invisible"),{"pointer-events-none":c}),"data-origin":r,"data-v0":!0,id:t,loading:"eager",onLoad:o,ref:l,sandbox:"allow-scripts allow-same-origin allow-forms allow-downloads allow-popups-to-escape-sandbox allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-presentation",src:"".concat(r).concat(a),fetchPriority:"high"})}var t$=l(48400),tK=l(26163),tQ=l(64495);function tX(e){let{error:t,onDismiss:l}=e,{submit:s}=(0,tQ.yI)(),{isAuthor:a}=(0,td.Pk)(),r=(0,ej.oQ)(),{isCopied:o,copyToClipboard:c}=(0,g.C)({timeout:2e3}),[d,u]=(0,i.useState)(!1);return t?(0,n.jsx)("div",{className:"light absolute bottom-0 left-0 z-10 max-w-[400px] p-4",children:(0,n.jsxs)("div",{className:"text-background flex min-w-[300px] flex-col items-center gap-3 rounded-[8px] bg-red-600 p-2 text-sm",role:"alert",children:[(0,n.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,n.jsxs)("div",{className:"flex w-full items-center justify-between font-semibold",children:[(0,n.jsx)("span",{children:"Error"})," ",(0,n.jsxs)(b.$,{className:"text text-background m-[-4px] hover:text-gray-200",onClick:l,size:"xs",variant:"ghost",children:[(0,n.jsx)(t$.a,{}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,n.jsx)("div",{className:"flex w-full",children:(0,n.jsx)("span",{className:(0,f.cn)("font-small text-background cursor-pointer overflow-hidden whitespace-pre-wrap font-mono text-[11px]",{"line-clamp-2":!d}),onClick:()=>u(!d),children:t})})]}),a&&(0,n.jsxs)("div",{className:"flex w-full justify-end gap-2 align-middle",children:[(0,n.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:()=>{c(t)},size:"sm",variant:"link",children:(0,n.jsx)(tK.U,{isCopied:o})}),(0,n.jsx)("div",{className:"border-alpha-400 border-l"}),(0,n.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",onClick:()=>{(0,eq.Ny)()&&r(!1),s({type:"fix-with-v0",action:"fix-with-v0",input:"The code returns the following error:\n```\n".concat(t,"\n```\nRevise the code to address the error.")})},size:"sm",variant:"secondary",children:["Fix with ",(0,n.jsx)(eX.o,{className:"mt-[1px]"})]})]})]})}):null}function tY(e,t){let l=isNaN(parseInt(e))?e:"An unexpected error occurred (".concat(e,")");return t?"".concat(l,"\n\n").concat(t):l.replace("FatalRendererError: ","")}var tq=l(93004);class tJ{}tJ.getIsPreviewable=e=>{let{source:t,closed:l,meta:n}=e,i=function(e,t){if(t){if(t.startsWith("use-"))return tE.REACT_HOOKS;if("instrumentation.ts"===t)return tE.INSTRUMENTATION_UNSUPPORTED;let e=t.split("."),l=e[e.length-1],n=e.length>2?e[e.length-2]:void 0;if(l&&!tR.some(e=>l===e))return tE.NON_JS_TS_FILE_UNSUPPORTED;if(n&&("test"===n||"spec"===n))return tE.TEST_FILES_UNSUPPORTED}for(let[t,l]of tC)if(new RegExp("from ['\"]".concat(t.replace("/","/"),"['\"]")).test(e))return l;return/\<ClerkProvider/.test(e)?tE.CLERK_UNSUPPORTED:/export default function (Root)?Layout/.test(e)?tE.LAYOUT_UNSUPPORTED:/(^|\n)['"]use server['"]/.test(e)?tE.SERVER_ACTION_UNSUPPORTED:/export default async function/.test(e)?tE.RSC_UNSUPPORTED:/(API_KEY|_SECRET) =/.test(e)||/YOUR_API_KEY/.test(e)?tE.API_KEY_UNSUPPORTED:!tS.some(t=>new RegExp("export (default )?async function ".concat(t,"\\(")).test(e)||new RegExp("export const ".concat(t," =")).test(e))||tE.ROUTE_HANDLER_UNSUPPORTED}(t,n.file);return"string"==typeof i?{error:i}:!!i&&l},tJ.Render=i.memo(e=>{let t=(0,td.jo)(),{isPublished:l}=(0,P.usePublishedPage)(),{chatId:s}=(0,td.xz)(),{getBlockForked:a}=(0,tq.t)(),{activeTab:r,setActiveTab:c,hasBlockPreview:d}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),{projectBlocks:u,projectBlockIndex:m,allBlocks:f}=(0,eb.P6)({blockId:e.blockId}),p=(0,i.useMemo)(()=>{var e;let t={},l=(null===(e=u[m])||void 0===e?void 0:e.meta.file)||".";for(let e of f)e.resultId&&e.meta.file&&(t[e.meta.file]=e.resultId);for(let e=0;e<=m;e++){let l=u[e],n=l.meta.file;n&&l.resultId&&(t[n]=l.resultId)}return{mapping:t,rootFileName:l}},[f,u,m]),h=(0,i.useRef)(null),[x,v]=(0,i.useState)(null);return(0,i.useEffect)(()=>{if(h.current)return function(e,t){let l=tb.get(e)||Math.random().toString();return tb.set(e,l),tN.push({id:l,listener:t}),()=>{let e=tN.findIndex(e=>e.listener===t);e>=0&&tN.splice(e,1)}}(h.current,t=>{switch(t.type){case"set_loading":h.current&&(tw(h.current,{type:"parent_ready"}),tw(h.current,{type:"sync_file_mapping",data:p}));break;case"error":case"runtime-error":{let l=tY(t.error);t.resultId===e.resultId&&v(n=>(n!==l&&e.isPreviewable&&(0,o.u)("V0BlockPreviewError",{messageId:e.messageId,blockId:e.blockId,resultId:t.resultId,from:e.meta.isQuickEdit?"quick-edit":void 0,forkedFromBlockId:a(e.blockId)},{errorMsg:l,errorCode:tW.rU}),l));break}case"started_visible_render":e.setIsPreviewable(!0)}})},[a,e,e.blockId,e.meta.from,e.resultId,e.setIsPreviewable,p,t]),(0,i.useEffect)(()=>{v(null)},[e.blockId]),(0,n.jsxs)(ta,{activeTab:r,allowRefresh:!0,hasBlockPreview:d,setActiveTab:c,...e,blockType:"v0",language:"typescriptreact",children:[x?(0,n.jsx)(tX,{error:x,onDismiss:()=>{v(null)}}):null,e.resultId&&"boolean"==typeof e.isPreviewable?(0,n.jsx)(tG,{activeTab:r,iframeId:(0,I.j)(e.resultId),iframeRef:h,isPublished:l,onLoad:()=>{h.current&&tw(h.current,{type:"sync_file_mapping",data:p})},origin:tj(s||e.blockId),src:"/p/".concat(e.resultId,"?c=1&flags=1&bid=").concat(e.blockId)}):null]})}),tJ.Actions=i.memo(e=>{let{hasBlockPreview:t,activeTab:l,setActiveTab:i}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,n.jsx)(I.r,{hasBlockPreview:t,activeTab:l,setActiveTab:i})}),tJ.TitleActions=()=>null;var t0=l(18342),t1=l(33027);let t5=e=>{let t=(0,t1.Q)(),l=t.globalSessionTokenCache||(t.globalSessionTokenCache=new Map),{data:n,error:i}=(0,t0.A)(e?"/chat/api/chat/frame-token?bid=".concat(e):null,async e=>{let t=await fetch(e);if(!t.ok)throw Error("Failed to fetch session token");return t.text()});return"string"!=typeof n||"string"!=typeof e||l.has(e)||l.set(e,n),{token:void 0===e?void 0:l.get(e),error:i}};var t2=l(82328),t3=l(52735),t4=l(35478),t9=l(4678);function t7(e){let{status:t="log"}=e;return(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg",className:"absolute -translate-y-0.5 translate-x-0.5",children:(0,n.jsx)("circle",{cx:"12.5",cy:"5.5",r:"3.5",strokeWidth:"1.5",stroke:"hsl(var(--background))",className:"error"===t?"fill-red-500":"log"===t?"fill-blue-600":"fill-yellow-500"})})}function t6(e){let{blockId:t,isPreviewable:l,closed:i}=e,{hasBlockPreview:s,activeTab:a,setActiveTab:r}=(0,tP.P5)({blockId:t,isPreviewable:l}),o=(0,O.k)("previewBlock"),[c]=eB(t),d=e=>({key:"preview",disabled:!(0,eZ.O)(s),tooltip:"object"==typeof s&&"error"in s?s.error:i?e?o("preview"):void 0:o("previewIsStreaming"),display:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(M.p,{className:"group-disabled:hidden"}),(0,n.jsx)("div",{className:"hidden group-disabled:block",children:i?(0,n.jsx)(A.X,{}):(0,n.jsx)(j.y,{size:16})}),e?null:(0,n.jsx)("span",{children:o("preview")})]})}),u=e=>({key:"code",tooltip:e?o("code"):void 0,display:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[c?(0,n.jsx)(t7,{status:"warn"}):null,(0,n.jsx)(t9.Y,{}),e?null:(0,n.jsx)("span",{children:o("code")})]})});return(0,n.jsxs)("div",{className:"@container/tabs flex-1",children:[(0,n.jsx)("div",{className:"@[11rem]/tabs:hidden flex items-center gap-2",children:(0,n.jsx)(R.wb,{disableOverflow:!0,tabs:[d(!0),u(!0)],activeTabKey:a,setActiveTabKey:r,isLoading:!1})}),(0,n.jsx)("div",{className:"@[11rem]/tabs:flex hidden items-center gap-2",children:(0,n.jsx)(R.wb,{disableOverflow:!0,tabs:[d(!1),u(!1)],activeTabKey:a,setActiveTabKey:r,isLoading:!1})})]})}var t8=l(19093),le=l(18742);function lt(e){let{errors:t,onDismiss:l}=e,{submit:s}=(0,tQ.yI)(),{isAuthor:a}=(0,td.Pk)(),r=(0,ej.oQ)(),[o,c]=(0,i.useState)(!1),{isCopied:d,copyToClipboard:u}=(0,g.C)({timeout:2e3}),[m,p]=(0,i.useState)(0),[h,x]=(0,i.useState)(!1),v=(0,i.useMemo)(()=>t.find(e=>e.isFatal),[t]),j=(0,i.useCallback)(()=>{m<=0?p(t.length-1):p(m-1)},[t,m]),y=(0,i.useCallback)(()=>{m>=t.length-1?p(0):p(m+1)},[t,m]);if(!t.length)return null;let w=()=>{var e;u(null!==(e=null==v?void 0:v.text)&&void 0!==e?e:t[m].text)},k=()=>{var e;c(!0),v||l();let n="The code returns the following error:\n```\n".concat(null!==(e=null==v?void 0:v.text)&&void 0!==e?e:t[m].text,"\n```\nRevise the code to address the error.");(0,eq.Ny)()&&r(!1),s({type:"fix-with-v0",action:"fix-with-v0",input:n})};return v?(0,n.jsx)("div",{className:"flex w-full justify-center",children:(0,n.jsx)("div",{className:"text-foreground absolute z-10 flex min-h-full max-w-4xl flex-col items-center justify-center px-10 top-9",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("h1",{className:"text-nowrap text-2xl font-semibold",children:"Runtime Error"}),(0,n.jsxs)("div",{className:"border-l-alpha-600 ml-5 flex flex-col gap-2 border-l pl-5",children:[(0,n.jsx)("h2",{className:"text-sm",children:v.text}),a&&(0,n.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,n.jsx)(b.$,{className:"border-background text-foreground bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:w,size:"sm",variant:"link",children:(0,n.jsx)(tK.U,{isCopied:d})}),(0,n.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",onClick:k,size:"sm",variant:"secondary",disabled:o,children:["Fix with ",(0,n.jsx)(eX.o,{className:"mt-[1px]"})]})]})]})]})})}):(0,n.jsx)("div",{className:"light absolute bottom-0 left-0 z-10 max-w-[400px] p-4",children:(0,n.jsxs)("div",{className:"text-background flex min-w-[300px] flex-col items-center gap-3 rounded-[8px] bg-red-600 p-2 text-sm",role:"alert",children:[(0,n.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,n.jsxs)("div",{className:"flex w-full items-center justify-between font-semibold",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{children:t[m].isServer?"Server":null})," Error"]})," ",(0,n.jsxs)(b.$,{className:"text text-background m-[-4px] hover:text-gray-200",onClick:l,size:"xs",variant:"ghost",children:[(0,n.jsx)(t$.a,{}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,n.jsx)("div",{className:"flex w-full",children:(0,n.jsx)("span",{className:(0,f.cn)("font-small text-background cursor-pointer overflow-hidden whitespace-pre-wrap font-mono text-[11px]",{"line-clamp-2":!h}),onClick:()=>x(!h),children:t[m].text})})]}),(0,n.jsxs)("div",{className:"flex w-full justify-between gap-2 align-middle",children:[(0,n.jsx)("div",{className:"flex items-center gap-2 align-middle",children:t.length>1&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:j,variant:"link",children:(0,n.jsx)(t8.J,{})}),(0,n.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:y,variant:"link",children:(0,n.jsx)(le.c,{})}),(0,n.jsxs)("span",{className:"text-xs",children:[m+1," of ",t.length]})]})}),(0,n.jsx)("div",{className:"flex items-center gap-2 align-middle",children:a&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b.$,{className:"border-background text-background bg-transparent px-1.5 py-0.5 hover:no-underline",onClick:w,size:"sm",variant:"link",children:(0,n.jsx)(tK.U,{isCopied:d})}),(0,n.jsx)("div",{className:"border-alpha-400 border-l"}),(0,n.jsxs)(b.$,{className:"h-6 rounded-md px-1.5 py-0.5 text-xs",onClick:k,size:"sm",variant:"secondary",children:["Fix with ",(0,n.jsx)(eX.o,{className:"mt-[1px]"})]})]})})]})]})})}var ll=l(945),ln=l(51425),li=l(30009);let ls=(0,li.createServerReference)("6036fe04632fa4905d0c0623e200f79c31d3aea028",li.callServer,void 0,li.findSourceMapURL,"updateBlockError");var la=l(23063);class lr{static Render(e){let{isPublished:t}=(0,P.usePublishedPage)(),{token:l,error:s}=t5(e.blockId),{activeForkKey:a}=(0,td.Pk)(),{canWriteToChat:r}=(0,eW.tZ)(),[c,d]=(0,i.useState)([]),u=(0,eF.F)(e.isPreviewable),{getBlockForked:m}=(0,tq.t)(),f=(0,t4.x)(),{afre:p}=(0,la.D)();(0,i.useEffect)(()=>{d([])},[e.blockId,d]);let{projectBlocks:h,projectBlockIndex:x}=(0,eb.P6)({blockId:e.blockId}),{activeTab:v,setActiveTab:g,hasBlockPreview:b}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),j=(0,i.useMemo)(()=>{if("code-project"===e.meta.type)return(0,Y.A2)({source:e.source,blockType:"code-project",blockId:e.blockId})},[e.source,e.blockId,e.meta.type]),y=(0,i.useMemo)(()=>{if(e.closed||!j||!j.length)return;let t=j[j.length-1];if("file"in t.meta&&!t.isDeleted)return t.meta.file},[j,e.closed]),w=(0,i.useMemo)(()=>{if(!j)return;let e=[],t=new Map,l=h.slice(0,x),n=new Map;for(let t of l){let l=(0,Y.A2)({source:t.source,blockType:"code-project",blockId:t.id});e.push(...l)}for(let l of(e.push(...j),e)){let e=t.get(l.meta.file);e?t.set(l.meta.file,{...l,originalCode:e.source}):t.set(l.meta.file,{...l,originalCode:l.isQuickEdit&&!l.source?"// ".concat(l.isAttachmentQuickEdit?"Reading from":"Generating"," ").concat(l.meta.file):void 0}),n.has(l.meta.file)||n.set(l.meta.file,n.size)}return Array.from(t.values()).filter(e=>!e.isDeleted)},[x,h,j]),k=(0,eF.F)(w),N=(0,I.j)(e.blockId),{submit:E}=(0,tQ.yI)();(0,i.useEffect)(()=>{let t=t=>{if(t.data&&"object"==typeof t.data&&t.data.__v0_remote__){if("error"===t.data.type){let l=tY(t.data.error,t.data.stack);d(n=>n.some(e=>e.text===l)||!u.current?n:(0===n.length&&p&&ls(e.blockId,l),(0,o.u)(t.data.isFatal?"V0BlockPreviewError":"V0BlockPreviewSoftError",{messageId:e.messageId,blockId:e.blockId,from:void 0!==e.meta.isQuickEdit?"quick-edit":void 0,forkedFromBlockId:m(e.blockId),resultId:e.resultId||""},{errorMsg:l,errorCode:tW.rU}),n.concat({isFatal:t.data.isFatal,isServer:t.data.isServer,text:l})))}if("frame_onload"===t.data.type&&d([]),("refine"===t.data.type||"add-refinement-element"===t.data.type)&&k.current){var l;let n=k.current.find(e=>e.meta.file===t.data.file);if(!n){alert("File not found");return}let i=n.source.split("\n"),s=t.data.line,r=t.data.column;for(;i[s-1].length<r;)r-=i[s-1].length,s++;for(;r-1<i[s-1].length&&/\s/.test(i[s-1][r-1]);)r++;let o=i.slice(Math.max(0,s-4),s-1),c=i[s-1],d=i.slice(s,s+3),u=null===(l=c.substring(r).match(/^[\w.]+/))||void 0===l?void 0:l[0],m=u?(s>4?"...\n":"")+o.join("\n")+"\n"+c+"\n"+(" ".repeat(r)+"^".repeat(u.length))+"\n"+d.join("\n")+"\n"+(s+3<i.length?"...\n":""):c;if("add-refinement-element"===t.data.type&&f){let{addRefinementElementToContext:e}=(0,ll.yQ)(f),{setComposerLayoutState:l}=(0,ln.w3)(f);e({id:t.data.id,componentName:u||"Component",sourceContext:m,file:n.meta.file}),requestAnimationFrame(()=>{l("compact")})}else if("refine"===t.data.type){let l=(0,t3.ru)({refinementElements:[{file:n.meta.file,componentName:u||"",sourceContext:m}],prompt:t.data.prompt}),i=(null==a?void 0:a.indexOf(e.messageId))||-1;a&&i>0&&i<a.length-1?E({action:"edit",input:l,userMessageId:a[i+1],type:"refinement"}):E({action:"new",input:l,attachments:[],type:"refinement"})}}}};return window.addEventListener("message",t),()=>{window.removeEventListener("message",t)}},[N,E,a,d,e.messageId,k,f,e.blockId,u,e.meta.isQuickEdit,m,e.resultId]);let C=null;if(e.blockId&&e.isPreviewable&&(l||s)){let i=new URLSearchParams;t&&i.set("mql","true"),s||!l?i.set("__v0",""):l&&i.set("__v0_token",l),e.isV3&&i.set("isV3","true"),C=(0,n.jsx)(tG,{activeTab:v,iframeId:N,isPublished:t,origin:function(e){let{disableLocalhost:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=function(e){let t="";for(let l=0;l<e.length;l++){let n=e.charCodeAt(l).toString(16);n.length<2&&(n="0"+n),t+=n}return BigInt("0x"+t).toString(36)}(e);if("generated.vusercontent.net".endsWith(".vercel.sh")){let e="generated.vusercontent.net".split(".")[0].replace(/^v0-frame-/g,"");return ty("".concat(l,"--").concat(e,".dev-lite.vusercontent.net"))}return ty("".concat(l,".lite.vusercontent.net"))}(e.blockId),src:"/?".concat(i.toString())}),"code-project"===e.meta.type&&(C=e.isV3?(0,n.jsx)("div",{className:"size-full","data-slot":"browser-content",children:C}):(0,n.jsx)(t2.A,{allowMobileFullscreen:e.allowMobileFullscreen,blockId:e.blockId,iframeId:N,devTools:r,isV3:e.isV3,children:(0,n.jsx)("div",{className:"flex-1 shrink-0","data-slot":"browser-content",children:C})}))}return(0,n.jsxs)(ta,{activeTab:v,hasBlockPreview:b,setActiveTab:g,initialFileTreeSize:e.initialFileTreeSize,...e,loadingPath:y,files:w,blockType:"code-project"===e.meta.type?"code-project":"v0",language:"typescriptreact",allowRefresh:"code-project"!==e.meta.type,allowFullScreen:"code-project"!==e.meta.type,isV3:e.isV3,initialConsoleSize:e.initialConsoleSize,initialConsoleExpanded:e.initialConsoleExpanded,children:[c.length?(0,n.jsx)(lt,{errors:c,onDismiss:()=>{d([])}}):null,C]})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:i}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,n.jsx)(I.r,{hasBlockPreview:t,activeTab:l,setActiveTab:i})}}lr.getIsPreviewable=e=>{let{closed:t,source:l,meta:n}=e;if(!t)return!1;let i=function(e,t){let l=/\.(ts|tsx|js|jsx|mjs|mts|cjs)$/i,n=!1,i="code-project"===t.type?(0,Y.A2)({source:e,blockType:"code-project",blockId:"fake-block-id"}):[{source:e,meta:t,isDeleted:!1}];if(!(i=i.filter(e=>!e.isDeleted))||0===i.length||!i.some(e=>e.meta.file&&(e.meta.file.endsWith(".tsx")||e.meta.file.endsWith(".jsx"))))return tT.NON_SUPPORTED_FILES;let s=i.filter(e=>e.meta.file&&l.test(e.meta.file));if(!s.length)return tT.NON_SUPPORTED_FILES;for(let{source:e}of s){let t=e.split("\n").filter(e=>e.trim().startsWith("import")).join("\n"),l=t.match(tA)||t.match(tM)||e.match(t_)||e.match(tO);if(l)return tI[l[1]];let i=t.match(tF)||t.match(tV)||e.match(tH)||e.match(tB);if(i)return{warning:tD[i[1]]};e.includes("export")&&(n=!0)}return!!n||tT.NO_EXPORTED_COMPONENT}(l,n);return"string"==typeof i?{error:i}:i},lr.TitleActions=i.memo(e=>{let{blockId:t,isPreviewable:l,closed:i}=e;return(0,n.jsx)(t6,{blockId:t,isPreviewable:l,closed:i})});class lo{static Actions(){return null}}function lc(e,t,l){let[n,s]=(0,i.useState)(!1),a=(0,eF.F)(n),r=(0,eF.F)(t);(0,i.useEffect)(()=>{let t=document.getElementById(l),n=l=>{if(l.origin===t.dataset.origin&&l.data.type===e+"_READY"&&(s(!0),r.current)){var n;null===(n=t.contentWindow)||void 0===n||n.postMessage({type:e+"_RENDER",source:r.current},t.dataset.origin||"")}};return window.addEventListener("message",n),()=>{window.removeEventListener("message",n)}},[e,l,r]),(0,i.useEffect)(()=>{let n=document.getElementById(l);if(n){var i,s;a.current?null===(i=n.contentWindow)||void 0===i||i.postMessage({type:e+"_RENDER",source:t},n.dataset.origin||""):null===(s=n.contentWindow)||void 0===s||s.postMessage({type:e+"_PING"},n.dataset.origin||"")}},[t,e,l,a])}lo.getIsPreviewable=()=>!1,lo.Render=i.memo(e=>(0,n.jsx)(ta,{activeTab:"code",hasBlockPreview:!1,hidePreviewPane:!0,setActiveTab:()=>{},...e,blockType:"code"})),lo.TitleActions=null;let ld=RegExp("<!DOCTYPE html>.*?<\\/html>","s");class lu{static Render(e){let{isPublished:t}=(0,P.usePublishedPage)(),{chatId:l}=(0,td.xz)(),{activeTab:i,setActiveTab:s,hasBlockPreview:a}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),r=(0,I.j)(e.blockId);return lc("HTML",e.source,r),(0,n.jsx)(ta,{activeTab:i,hasBlockPreview:a,setActiveTab:s,...e,blockType:"html",language:"html",children:(0,n.jsx)(tG,{activeTab:i,iframeId:r,isPublished:t,origin:tj(l||e.blockId),src:"/render/html"})})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:i}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,n.jsx)(I.r,{hasBlockPreview:t,activeTab:l,setActiveTab:i})}}lu.getIsPreviewable=e=>{let{source:t,closed:l}=e;return l||ld.test(t)},lu.TitleActions=null;var lm=l(80912),lf=l(72775),lp=l(74655),lh=l(41542),lx=l(22534);class lv{static Render(e){let{isPublished:t}=(0,P.usePublishedPage)(),{activeTab:l,setActiveTab:s,hasBlockPreview:a}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),[r,o]=(0,i.useState)(void 0),c=e.source.replaceAll(/\\+`/g,"`");return(0,n.jsx)(ta,{activeTab:l,hasBlockPreview:a,setActiveTab:s,...e,blockType:"markdown",language:"markdown",source:c,onEdit:o,children:(0,n.jsx)("div",{className:(0,f.cn)("flex h-full w-full justify-center overflow-y-auto p-4 md:py-6","preview"!==l&&(t?"hidden":"sr-only invisible")),children:(0,n.jsx)(lm.s,{children:(0,n.jsx)(lf.c,{remarkPlugins:[lp.A,lh.A],rehypePlugins:[lx.A],children:void 0===r?c:r})})})})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:i}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,n.jsx)(I.r,{hasBlockPreview:t,activeTab:l,setActiveTab:i})}}lv.getIsPreviewable=()=>!0,lv.TitleActions=null;class lg{static Render(e){let{chatId:t}=(0,td.xz)(),{isPublished:l}=(0,P.usePublishedPage)(),{activeTab:i,setActiveTab:s,hasBlockPreview:a}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),r=(0,I.j)(e.blockId);return lc("VUE",e.source,r),(0,n.jsx)(ta,{activeTab:i,allowRefresh:!0,hasBlockPreview:a,setActiveTab:s,...e,blockType:"vue",language:"vue",resultId:e.blockId,children:(0,n.jsx)(tG,{activeTab:i,iframeId:r,isPublished:l,origin:tj(t||e.blockId),src:"/render/vue"},r)})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:i}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,n.jsx)(I.r,{hasBlockPreview:t,activeTab:l,setActiveTab:i})}}lg.getIsPreviewable=e=>{let{closed:t}=e;return t},lg.TitleActions=null;class lb{static Render(e){let{chatId:t}=(0,td.xz)(),{isPublished:l}=(0,P.usePublishedPage)(),{activeTab:i,setActiveTab:s,hasBlockPreview:a}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable}),r=(0,I.j)(e.blockId);return lc("SVELTE",e.source,r),(0,n.jsx)(ta,{activeTab:i,hasBlockPreview:a,setActiveTab:s,...e,blockType:"svelte",language:"svelte",children:(0,n.jsx)(tG,{activeTab:i,iframeId:r,isPublished:l,origin:tj(t||e.blockId),src:"/render/svelte"},r)})}static Actions(e){let{hasBlockPreview:t,activeTab:l,setActiveTab:i}=(0,tP.P5)({blockId:e.blockId,isPreviewable:e.isPreviewable});return(0,n.jsx)(I.r,{hasBlockPreview:t,activeTab:l,setActiveTab:i})}}lb.getIsPreviewable=e=>{let{closed:t}=e;return t},lb.TitleActions=null;class lj{static Render(e){let{source:t,blockId:l,remoteInfo:s,closed:a}=e,{chatId:r}=(0,td.xz)(),o=(0,I.j)("remote-preview"),{data:d}=(0,c.Ay)(l?["remote:preview",l]:null,null,{fallbackData:(null==s?void 0:s.accepted)||!1}),{activeTab:u,setActiveTab:m}=(0,tP.P5)({blockId:e.blockId,isPreviewable:a});return(0,i.useEffect)(()=>{if(!a||!(l||r))return;let e=new AbortController,t=async()=>{try{await fetch("/chat/api/chat/remote/preview?".concat("@remote"===l?"cid=".concat(r):"bid=".concat(l)),{signal:e.signal})}catch(e){}};return setTimeout(()=>{t()},0),()=>{e.abort()}},[a,r,l]),(0,n.jsx)(ta,{activeTab:"@remote"===l?"preview":u,setActiveTab:m,...e,meta:"@remote"===l?{...e.meta}:{...e.meta,file:"Files"},allowFullScreen:!1,language:"plaintext",blockType:"local",remoteInfo:s,source:t,hasBlockPreview:!!d||e.closed,children:a||"@remote"===l?(0,n.jsx)(t2.A,{iframeId:o,children:(0,n.jsx)(tG,{activeTab:"@remote"===l?"preview":u,iframeId:o,isPublished:!1,origin:"",src:"/chat/api/chat/remote/proxy?cid=".concat(r)},o)}):null})}static Actions(e){let{blockId:t,isPreviewable:l}=e,{hasBlockPreview:i,activeTab:s,setActiveTab:a}=(0,tP.P5)({blockId:t,isPreviewable:l});return"@remote"===t?null:(0,n.jsx)(I.r,{hasBlockPreview:i,activeTab:s,setActiveTab:a})}}function ly(e){switch(e){case"node.js":case"nodejs":case"python":return tx;case"markdown":return lv;case"html":return lu;case"v0":case"react":case"tsx":return tJ;case"vue":return lg;case"svelte":return lb;case"code":return lo;case"local":return lj;case"code-project":return lr;case"inline-sql":return null}}function lw(e){var t;let{block:l,initialSize:s,initialConsoleSize:a,initialConsoleExpanded:r,initialFileTreeSize:o,allowMobileFullscreen:c,location:d="header",isAuthor:u}=e,{isPublished:m}=(0,P.usePublishedPage)(),{history:f,currentBlockIndex:p}=(0,eb.P6)({blockId:(null==l?void 0:l.id)||""}),h=l?ly(l.type):null,x=!!h&&!!l&&h.getIsPreviewable({source:l.source,closed:l.closed,meta:l.meta,id:l.id}),[v,g]=(0,i.useState)(),b=v||x;return((0,i.useEffect)(()=>{g(void 0)},[null==l?void 0:l.id]),l&&h)?{action:m&&"footer"!==d?null:(0,n.jsx)(h.Actions,{blockId:l.id,isPreviewable:b,closed:l.closed}),titleActions:"code-project"===l.meta.type&&h.TitleActions?(0,n.jsx)(h.TitleActions,{blockId:l.id,isPreviewable:b,closed:l.closed}):null,content:(0,n.jsx)(h.Render,{allowMobileFullscreen:c,initialFileTreeSize:o,blockId:l.id,resultId:l.resultId,closed:l.closed,initialOutputSize:s,messageId:l.messageId,language:l.language,meta:l.meta,source:l.source,remoteInfo:l.remoteInfo,isPreviewable:b,isAuthor:u,setIsPreviewable:g,hasSourceBeenEdited:l.hasSourceBeenEdited,originalCode:p>0?null===(t=f[p-1])||void 0===t?void 0:t.source:void 0,latestDeploymentInfo:l.latestDeploymentInfo,initialConsoleSize:null!=a?a:void 0,initialConsoleExpanded:null!=r?r:void 0})}:{action:null,content:null}}function lk(e){let{block:t,allowMobileFullscreen:l,initialSize:n}=e,{content:i}=lw({block:t,initialSize:n,allowMobileFullscreen:l,location:void 0});return i}lj.getIsPreviewable=e=>{let{closed:t}=e;return t},lj.TitleActions=null},18933:(e,t,l)=>{"use strict";l.d(t,{AF:()=>a,LS:()=>u,O$:()=>o,R8:()=>c,XJ:()=>r,gT:()=>m,xp:()=>n});let n=10;function i(e){return Math.round(1e4*e)/1e4}function s(e){let t=e.filter(e=>e.visible);if(0===t.length)return e;if(1===t.length)return e.map(e=>e.visible?{...e,ratio:1}:e);let l=t.reduce((e,t)=>e+t.ratio,0);if(.001>=Math.abs(l-1))return e;let n=1/l;return e.map(e=>e.visible?{...e,ratio:i(e.ratio*n)}:e)}function a(e,t){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.panelsLayout.findIndex(e=>e.id===t);if(-1===n||!e.panelsLayout[n].visible)return e;let a=e.panelsLayout.filter(e=>e.visible);if(a.length<=1)return{panelsLayout:e.panelsLayout.map(e=>e.id===t?{...e,visible:!1,savedRatio:e.ratio,ratio:0,savedVisibility:l?e.visible:e.savedVisibility}:e),mobilePanel:e.mobilePanel};let r=a.filter(e=>e.id!==t).reduce((e,t)=>e+t.ratio,0),o=r>0?1/r:0,c=e.panelsLayout.map(e=>e.id===t?{...e,visible:!1,savedRatio:e.ratio,ratio:0,savedVisibility:l?e.visible:e.savedVisibility}:e.visible?{...e,ratio:i(e.ratio*o)}:e),d=e.mobilePanel;if(e.mobilePanel===t){let e=c.find(e=>e.visible);e&&(d=e.id)}return{panelsLayout:s(c),mobilePanel:d}}function r(e,t){let l=e.panelsLayout.findIndex(e=>e.id===t);if(-1===l||e.panelsLayout[l].visible)return e;let n=e.panelsLayout[l],a=e.panelsLayout.filter(e=>e.visible);if(0===a.length)return{panelsLayout:e.panelsLayout.map(e=>e.id===t?{...e,visible:!0,ratio:1}:e),mobilePanel:e.mobilePanel};let r=Math.max(.2,n.savedRatio||.2),o=a.reduce((e,t)=>e+t.ratio,0),c=Math.min(r,.8),d=i(1-c)/o;return{panelsLayout:s(e.panelsLayout.map(e=>e.id===t?{...e,visible:!0,ratio:c}:e.visible?{...e,ratio:i(e.ratio*d)}:e)),mobilePanel:e.mobilePanel}}function o(e,t){return -1===e.panelsLayout.findIndex(e=>e.id===t)?e:{panelsLayout:e.panelsLayout.map(e=>({...e,savedRatio:e.visible?e.ratio:e.savedRatio,savedVisibility:e.visible,visible:e.id===t,ratio:+(e.id===t)})),mobilePanel:t}}function c(e,t,l,n){let a=e.panelsLayout.findIndex(e=>e.id===t),r=e.panelsLayout.findIndex(e=>e.id===l);if(-1===a||-1===r||!e.panelsLayout[a].visible||!e.panelsLayout[r].visible)return e;let o=e.panelsLayout[a],c=e.panelsLayout[r],d=i(o.ratio+n),u=i(c.ratio-n);if(d<.2||u<.2)return e;let m=e.panelsLayout.map(e=>e.id===t?{...e,ratio:d}:e.id===l?{...e,ratio:u}:e);return{...e,panelsLayout:s(m)}}function d(e,t){let l=[];return e.panelsLayout.forEach((n,i)=>{if(l.push(n.visible?"".concat(n.ratio,"fr"):"0fr"),i<e.panelsLayout.length-1){let s=e.panelsLayout.slice(i+1).find(e=>e.visible),a=n.visible&&s?"".concat(t,"px"):"0px";l.push(a)}}),l.join(" ")}function u(e){return{gridTemplateAreas:function(e){let t=[];return e.panelsLayout.forEach((l,n)=>{t.push(l.id),n<e.panelsLayout.length-1&&t.push("resize-".concat(n))}),'"'.concat(t.join(" "),'"')}(e),desktopGridTemplateColumns:d(e,n),desktopGridTemplateColumnsUsingCqw:d(e,n),mobileGridTemplateColumns:e.panelsLayout.map(t=>t.id===e.mobilePanel?"1fr":"0px").join(" ")}}function m(e){return 1!==e.panelsLayout.filter(e=>e.visible).length?e:{panelsLayout:s(e.panelsLayout.map(e=>!0===e.savedVisibility?{...e,visible:!0,ratio:e.savedRatio||.2}:e)),mobilePanel:e.mobilePanel}}},32178:(e,t,l)=>{"use strict";l.d(t,{o:()=>s});var n=l(7336),i=l(4495);function s(e){let{className:t,children:l,bottomBorder:s,onePixelShorter:a}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex w-full shrink-0 items-center pl-3 pr-2 text-[13px] font-medium text-gray-500",a?"h-[calc(2.25rem-1px)]":"h-9",s&&"border-alpha-200 border-b",t),"data-slot":"block-tab-header",children:l})}},33027:(e,t,l)=>{"use strict";l.d(t,{DataProvider:()=>a,Q:()=>r});var n=l(7336),i=l(80644);let s=(0,i.createContext)({});function a(e){let{children:t}=e;return(0,n.jsx)(s.Provider,{value:{},children:t})}function r(){return(0,i.use)(s)}},38436:(e,t,l)=>{"use strict";l.d(t,{EE:()=>g,l1:()=>x});var n=l(27007),i=l(4490),s=l(53682),a=l(94585),r=l(7222),o=l(51425),c=l(18933),d=l(55074);let u=new Map,m=(0,a.G)(u,()=>({resizingId:(0,n.eU)(null),isReordering:(0,n.eU)(!1),disableLayoutAnimations:(0,n.eU)(!1)}));function f(e){return Object.freeze(e.map(e=>e.id))}function p(e){return Object.freeze(e.filter(e=>e.visible).map(e=>e.id))}let h=new Map,x=(0,a.G)(h,e=>{let t=m(e),{panelsLayout:l,mobilePanel:a}=(0,s.Op)(e),r=(0,d.jP)(e),o=(0,i.mg)(l,f,(e,t)=>e.length===t.length&&e.every((e,l)=>e===t[l])),u=(0,i.mg)(l,p,(e,t)=>e.length===t.length&&e.every((e,l)=>e===t[l])),h=(0,n.eU)(e=>{let t=e(l),n=e(a);return(0,c.LS)({panelsLayout:t,mobilePanel:n})}),x=(0,n.eU)(e=>null!==e(r.getChatData)&&!!e(r.activeBlock));return{...t,panelsLayout:l,mobilePanel:a,gridProperties:h,isResizing:(0,n.eU)(e=>null!==e(t.resizingId)),panelOrder:o,visiblePanels:u,controlsEnabled:x,isEmptyStateVisible:(0,n.eU)(e=>0===e(u).length)}}),v=new Map,g=(0,a.G)(v,e=>{let t=m(e),{panelsLayout:l,mobilePanel:n}=(0,s.Op)(e),i=(0,o.w3)(e),a=e=>{let i=r.M.get(l),s=r.M.get(n),a=i.some(e=>"chat"===e.id&&e.visible),o=i.some(e=>"editor"===e.id&&e.visible),d=i.some(e=>"block"===e.id&&e.visible),u={panelsLayout:i,mobilePanel:s};if(a&&["block","editor"].includes(e)){let l="block";"block"===e&&(l="editor");let n=u.panelsLayout.find(e=>e.id===l&&e.visible),i=u.panelsLayout.find(t=>t.id===e&&!t.visible);n&&i&&(r.M.set(t.disableLayoutAnimations,!0),i.savedRatio=n.ratio,u=(0,c.AF)(u,n.id)),requestAnimationFrame(()=>{r.M.set(t.disableLayoutAnimations,!1)})}"chat"===e&&o&&d&&(u=(0,c.AF)(u,"editor")),u=(0,c.XJ)(u,e),r.M.set(l,u.panelsLayout),r.M.set(n,u.mobilePanel)},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=r.M.get(l),s=r.M.get(n),a=(0,c.AF)({panelsLayout:i,mobilePanel:s},e,t);r.M.set(l,a.panelsLayout),r.M.set(n,a.mobilePanel)};return{setIsResizing:e=>{null!==e&&i.setComposerLayoutState("collapsed"),r.M.set(t.resizingId,e)},resizePanel:e=>{let{index:t,delta:i}=e,s=r.M.get(l),a=r.M.get(n),o=s[t],d=s.slice(t+1).find(e=>e.visible);if(!o||!d||!o.visible||!d.visible)return!1;let u={panelsLayout:s,mobilePanel:a},m=(0,c.R8)(u,o.id,d.id,i);return m!==u&&(r.M.set(l,m.panelsLayout),!0)},movePanel:e=>{let{id:n,direction:i}=e,s=r.M.get(l),a=s.findIndex(e=>e.id===n),o=((e,t)=>{let l="left"===t?-1:1,n=e+l;for(;n>=0&&n<s.length;){if(s[n].visible)return n;n+=l}return -1})(a,i);if(-1===a||-1===o||!s[a].visible)return;r.M.set(t.isReordering,!0);let c=[...s],d=c[a];c[a]=c[o],c[o]=d,r.M.set(l,c),requestAnimationFrame(()=>{r.M.set(t.isReordering,!1)})},togglePanel:e=>{let t=r.M.get(l).find(t=>t.id===e);t&&(t.visible?d(e):a(e))},openPanel:a,closePanel:d,fullscreenPanel:e=>{let t=r.M.get(l),i=r.M.get(n),s=(0,c.O$)({panelsLayout:t,mobilePanel:i},e);r.M.set(l,s.panelsLayout),r.M.set(n,s.mobilePanel)},restoreSavedVisibility:()=>{let e=r.M.get(l),t=r.M.get(n),i=(0,c.gT)({panelsLayout:e,mobilePanel:t});r.M.set(l,i.panelsLayout),r.M.set(n,i.mobilePanel)},setMobilePanel:e=>{r.M.set(n,e)},setPanelsLayout:e=>{r.M.set(l,e)},isPanelFullscreen:e=>{let t=r.M.get(l);return t.some(t=>t.id===e&&t.visible)&&t.every(t=>t.id===e||!t.visible)}}})},40255:(e,t,l)=>{"use strict";l.d(t,{V:()=>i});var n=l(59103);function i(e){let{blockId:t}=e,{data:l,mutate:i}=(0,n.Ay)(["block:editValueMap",t],{fallbackData:{}});return{editValueMap:l||{},setEditValueMap:i}}},45459:(e,t,l)=>{"use strict";l.d(t,{FullscreenContainer:()=>c});var n=l(7336),i=l(47192),s=l(4495),a=l(49388),r=l(51621),o=l(17781);function c(e){let{children:t,allowOnMobile:l}=e,{fullScreenResult:c,setFullscreenResult:d,source:u}=(0,i.S)(),m=(0,o.$)(),f=c&&(l||!m);(0,a.ML)("keydown",e=>{"Escape"===e.key&&d(!1)});let p=e=>{if(!e){d(!1);return}e.target===e.currentTarget&&d(!1)},h=(0,n.jsx)("div",{className:(0,s.cn)(f?"fixed inset-3":"size-full",f&&"ssr"!==u&&"animate-in zoom-in-90"),children:(0,n.jsx)("div",{className:(0,s.cn)("bg-background size-full !overflow-clip",f&&"rounded-lg"),children:t})}),x=(0,s.cn)(f?"bg-alpha-700 dark:bg-alpha-900 fixed inset-0 z-[60]":"h-full w-full",f&&"ssr"!==u&&"animate-in fade-in duration-300");return"ssr"===u?(0,n.jsx)("div",{"data-testid":"fullscreen-overlay-ssr",className:x,onClick:p,children:h}):(0,n.jsx)(r.P.div,{"data-testid":"fullscreen-overlay",className:x,onClick:p,children:h})}},47192:(e,t,l)=>{"use strict";l.d(t,{S:()=>s});var n=l(80644),i=l(59103);function s(){var e;let{data:t,mutate:l}=(0,i.Ay)("result:full-screen"),{mutate:s}=(0,i.Ay)("state:select"),a=(0,n.useCallback)(e=>{l(t=>{if(!t&&!e)return;let l=new URL(window.location.href),n=l.searchParams;return n.get("b")&&(n.set("f",e?"1":"0"),l.search=n.toString(),window.history.replaceState({},"",l.toString())),s(!1),{value:e}})},[l,s]);return{fullScreenResult:null!==(e=null==t?void 0:t.value)&&void 0!==e&&e,setFullscreenResult:a,source:null==t?void 0:t.source}}},51425:(e,t,l)=>{"use strict";l.d(t,{Nq:()=>u,w3:()=>m});var n=l(27007),i=l(53682),s=l(7222),a=l(94585),r=l(38436);let o=new Map,c=(0,a.G)(o,()=>({toasts:(0,n.eU)([])})),d=new Map,u=(0,a.G)(d,e=>{let t=c(e),l=(0,i.Op)(e),s=(0,r.l1)(e),a=e=>"compact"===e,o=l.composerLayout;return{...t,composerLayoutState:o,isComposerUnfurled:(0,n.eU)(e=>a(e(o))),isPromptVisible:(0,n.eU)(e=>a(e(o))),isComposerVisible:(0,n.eU)(e=>!e(s.visiblePanels).includes("chat"))}});function m(e){let t=c(e),l=(0,i.Op)(e);return{setComposerLayoutState:e=>{s.M.set(l.composerLayout,e)},setToasts:e=>s.M.set(t.toasts,e),toast:function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=Date.now(),i=s.M.get(t.toasts);s.M.set(t.toasts,[...i,{content:e,timestamp:n,variant:l}]),setTimeout(()=>{s.M.set(t.toasts,s.M.get(t.toasts).filter(e=>e.timestamp!==n))},3e3)}}}},53682:(e,t,l)=>{"use strict";l.d(t,{Op:()=>u,MO:()=>m,fB:()=>f});var n=l(27007),i=l(171),s=l(94585),a=l(7222),r=l(20287);function o(){let e=r.A.get(i.rD);return(0,i.Ik)(e)}function c(e,t){!function(e){let t=(0,i.$N)(e);for(;t.length>2048&&Object.keys(e).length>0;){let l=function(e){var t;return null!==(t=Object.entries(e).sort((e,t)=>{let[,l]=e,[,n]=t;return(0,i.q_)(l.lastUpdated,n.lastUpdated)}).map(e=>{let[t]=e;return t})[0])&&void 0!==t?t:null}(e);if(!l)break;delete e[l],t=(0,i.$N)(e)}r.A.set(i.rD,t)}({...o(),[e]:t})}let d=new Map,u=(0,s.G)(d,e=>{let t=f(e);function l(e,t,l){let n=f(e);c(e,{...n,[t]:l,lastUpdated:(0,i.tD)()})}let s=(0,n.eU)(t.composerLayout,(t,n,i)=>{l(e,"composerLayout",i),n(s,i)}),a=(0,n.eU)(t.panelsLayout,(t,n,i)=>{l(e,"panelsLayout",i),n(a,i)}),r=(0,n.eU)(t.mobilePanel,(t,n,i)=>{l(e,"mobilePanel",i),n(r,i)}),o=(0,n.eU)(t.sidebar,(t,n,i)=>{l(e,"sidebar",i),n(o,i)}),d=(0,n.eU)(t.lastUpdated,(t,n,i)=>{l(e,"lastUpdated",i),n(d,i)});return{composerLayout:s,panelsLayout:a,mobilePanel:r,sidebar:o,lastUpdated:d}});function m(e){let t=e?Object.keys(e):[],l=o();return Array.from(new Set([...l?Object.keys(l):[],...Array.from(d.keys()),...t]))}function f(e,t){if(t&&e in t)return t[e];let l=function(e){let t=o();return t&&e in t?t[e]:null}(e);if(l)return l;let n=function(e){let t=d.get(e);if(!t)return null;let l=a.M.get(t.composerLayout),n=a.M.get(t.panelsLayout),i=a.M.get(t.mobilePanel);return{composerLayout:l,panelsLayout:n,mobilePanel:i,sidebar:a.M.get(t.sidebar),lastUpdated:a.M.get(t.lastUpdated)}}(e);if(n)return c(e,n),n;let s=i.h5;return c(e,s),s}},55655:(e,t,l)=>{"use strict";l.d(t,{r:()=>i});var n=l(80644);function i(){let[e,t]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{t(navigator.userAgent.toUpperCase().includes("MAC"))},[]),e}},67150:()=>{},71229:(e,t,l)=>{"use strict";l.d(t,{P:()=>n});let n={"fullscreen-chat":{panelsLayout:[{id:"chat",ratio:1,savedRatio:.3,visible:!0},{id:"block",ratio:0,savedRatio:.5,visible:!1},{id:"editor",ratio:0,savedRatio:.5,visible:!1}],mobilePanel:"chat"},developer:{panelsLayout:[{id:"chat",ratio:0,savedRatio:.3,visible:!1},{id:"block",ratio:.5,visible:!0},{id:"editor",ratio:.5,visible:!0}],mobilePanel:"editor"},"vibe-coder":{panelsLayout:[{id:"chat",ratio:0,savedRatio:.5,visible:!1},{id:"block",ratio:1,visible:!0},{id:"editor",ratio:0,savedRatio:.5,visible:!1}],mobilePanel:"block"},"classic-v0":{panelsLayout:[{id:"chat",ratio:.3,visible:!0},{id:"block",ratio:.7,visible:!0},{id:"editor",ratio:0,savedRatio:.5,visible:!1}],mobilePanel:"chat"}}},76308:(e,t,l)=>{"use strict";l.d(t,{h:()=>k});var n=l(7336),i=l(4495),s=l(77936),a=l(46556),r=l(80644),o=l(82545);let c=o.bL,d=o.R6,u=o.Ke;var m=l(81616),f=l(97210);function p(e){let{className:t}=e;return(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:(0,i.cn)(t),children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 13.5V6.5V5.41421C14.5 5.149 14.3946 4.89464 14.2071 4.70711L9.79289 0.292893C9.60536 0.105357 9.351 0 9.08579 0H8H3H1.5V1.5V8H3V1.5H8V5V6.5H9.5H13V13.5C13 14.0523 12.5523 14.5 12 14.5H6V16H12C13.3807 16 14.5 14.8807 14.5 13.5ZM9.5 5V2.12132L12.3787 5H9.5ZM2.31885 12.8194H0V11.3194H2.31885V9H3.81885V11.3194H6.13775V12.8194H3.81885V15.1377H2.31885V12.8194Z",fill:"currentColor"})})}function h(e){let{className:t}=e;return(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:(0,i.cn)(t),children:(0,n.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 6.5V13.5C14.5 14.8807 13.3807 16 12 16H5V14.5H12C12.5523 14.5 13 14.0523 13 13.5V6.5H9.5H8V5V1.5H3V9H1.5V1.5V0H3H8H9.08579C9.351 0 9.60536 0.105357 9.79289 0.292893L14.2071 4.70711C14.3946 4.89464 14.5 5.149 14.5 5.41421V6.5ZM9.5 2.12132V5H12.3787L9.5 2.12132ZM0 11.25V12.75H6V11.25H0Z",fill:"currentColor"})})}var x=l(7531),v=l(7407),g=l(61354);function b(e){let{added:t,removed:l,className:s}=e;if(!t&&!l)return null;let a=t?(0,n.jsx)("div",{className:"text-green-700",children:"number"==typeof t?"+".concat(t):"+"}):null,r=l?(0,n.jsx)("div",{className:"text-red-700",children:"number"==typeof l?"-".concat(l):"-"}):null;return(0,n.jsxs)("div",{className:(0,i.cn)("flex items-center gap-0.5 text-xs text-gray-500",s),children:[a,a&&r?(0,n.jsx)("div",{children:"/"}):null,r]})}function j(e){return e?(0,v.n)(e,(e,t)=>e.items&&!t.items?-1:!e.items&&t.items?1:e.title.localeCompare(t.title)):[]}let y=(0,r.createContext)(void 0),w=()=>{let e=(0,r.useContext)(y);if(void 0===e)throw Error("useFileTree must be used within a FileTreeProvider");return e};function k(e){let{loading:t,active:l,items:s,onSelect:a,FileActions:o,FolderActions:c,TreeActions:d,className:u,lockingStatus:m}=e,f=(0,r.useMemo)(()=>j(s),[s]),p=(0,n.jsx)("ul",{className:(0,i.cn)("group flex list-none flex-col",u),children:f.map(e=>(0,n.jsx)(N,{item:e},e.value))}),h=p;return d&&(h=(0,n.jsxs)(x.tz,{children:[(0,n.jsx)(x.Rc,{asChild:!0,children:p}),(0,n.jsx)(x.Ip,{children:(0,n.jsx)(x.Q2,{children:(0,n.jsx)(d,{})})})]})),(0,n.jsx)(y.Provider,{value:{onSelect:a,active:l,lockingStatus:m,loading:t,FileActions:null!=o?o:()=>null,FolderActions:null!=c?c:()=>null,TreeActions:null!=d?d:()=>null},children:h})}function N(e){let{item:t}=e;return t.items?(0,n.jsx)(P,{item:t}):(0,n.jsx)(E,{item:t})}function P(e){var t;let{className:l,item:s}=e,{active:a,FolderActions:o}=w(),[m,f]=(0,r.useState)(!0),p=!!s.items&&function e(t,l){return t.some(t=>t.value===l||!!t.items&&e(t.items,l))}(s.items,a);(0,r.useEffect)(()=>{p&&f(!0)},[p]);let h=(0,r.useMemo)(()=>j(s.items),[s.items]),v=(null===(t=s.items)||void 0===t?void 0:t.length)?(0,n.jsx)("div",{"data-sidebar":"menu-sub",className:"border-alpha-400 group-hover:border-l-alpha-400 duration-250 ml-3 flex min-w-0 translate-x-[0.5px] flex-col border-l border-l-transparent pl-1 transition-colors",children:h.map(e=>(0,n.jsx)(N,{item:e},e.value))}):null;return(0,n.jsxs)(x.tz,{children:[(0,n.jsxs)(c,{className:"flex flex-col gap-0",open:m,onOpenChange:f,children:[(0,n.jsx)(d,{asChild:!0,children:(0,n.jsx)(x.Rc,{asChild:!0,children:(0,n.jsx)(C,{icon:(0,n.jsx)(g.A,{className:(0,i.cn)("h-4 w-4 transition-transform",{"rotate-90":m})}),onClick:e=>{e.currentTarget instanceof HTMLButtonElement&&e.currentTarget.blur(),f(e=>!e)},className:l,status:null,children:s.title})})}),(0,n.jsx)(u,{children:v})]}),(0,n.jsx)(x.Ip,{children:(0,n.jsx)(x.Q2,{children:(0,n.jsx)(o,{item:s})})})]})}function E(e){let t,{item:l,className:o,...c}=e,{onSelect:d,active:u,loading:m,FileActions:v,lockingStatus:g}=w(),j=(0,r.useMemo)(()=>m===l.value?(0,n.jsx)(f.y,{size:16}):"binary"===l.type?(0,n.jsx)(s.Z,{}):l.addedCount&&!l.removedCount?(0,n.jsx)(p,{}):!l.addedCount&&l.removedCount?(0,n.jsx)(h,{}):(0,n.jsx)(s.Z,{}),[l.addedCount,l.removedCount,l.type,l.value,m]);return l.value?(t=(null==g?void 0:g.type)==="locking-all"||(null==g?void 0:g.type)==="unlocking-all"||((null==g?void 0:g.type)==="locking"||(null==g?void 0:g.type)==="unlocking")&&g.fileName===l.value||((null==g?void 0:g.type)==="locking-folder"||(null==g?void 0:g.type)==="unlocking-folder")&&l.value.startsWith(g.folderName)?(0,n.jsx)("div",{className:"flex items-center justify-end",children:(0,n.jsx)(f.y,{size:14,className:"m-0 w-fit p-0"})}):l.isLocked?(0,n.jsx)("div",{className:"flex items-center justify-end",children:(0,n.jsx)(a.C,{size:14,className:"m-0 w-fit p-0"})}):l.addedCount&&"binary"===l.type?(0,n.jsx)("div",{className:"flex items-center gap-0.5 text-xs text-green-700",children:"Added"}):(0,n.jsx)(b,{added:l.addedCount,removed:l.removedCount}),(0,n.jsxs)(x.tz,{children:[(0,n.jsx)(x.Rc,{asChild:!0,children:(0,n.jsx)(C,{active:l.value===u,onClick:()=>d(l.value),className:(0,i.cn)(o,l.isLocked&&"text-gray-500"),icon:j,status:t,...c,children:l.title})}),(0,n.jsx)(x.Ip,{children:(0,n.jsx)(x.Q2,{children:(0,n.jsx)(v,{item:l})})})]})):null}function C(e){let{className:t,active:l,icon:s,status:a,children:r,...o}=e;return(0,n.jsx)("li",{children:(0,n.jsxs)(m.$,{className:(0,i.cn)("data-[active=true]:bg-alpha-200 mb-0 h-[26px] w-full min-w-36 justify-between gap-2 pl-0.5 pr-1",t),"data-active":l,size:"sm",variant:"ghost",title:r,...o,children:[(0,n.jsxs)("div",{className:"flex min-w-0 items-center gap-1",children:[(0,n.jsx)("div",{className:"p-0.5 text-gray-500 group-focus:text-gray-900 group-[[data-active=true]]:text-gray-900",children:s}),(0,n.jsx)("span",{className:"truncate font-normal",children:r})]}),a]})})}},77055:(e,t,l)=>{"use strict";async function n(e){let t=await fetch("/chat/api/blocks",{method:"PUT",body:JSON.stringify(e)});if(!t.ok)return{success:!1};let l=await t.json();return{success:l.success,transformedSource:l.success?l.transformedSource:void 0}}l.d(t,{Z:()=>n})},82328:(e,t,l)=>{"use strict";l.d(t,{A:()=>P,q:()=>N});var n=l(7336),i=l(80644),s=l(19093),a=l(18742),r=l(25339),o=l(47309),c=l(74654),d=l(86358),u=l(35339),m=l(67952),f=l(47192),p=l(4495);l(67150);var h=l(4371),x=l(32178),v=l(48963),g=l(17781),b=l(21491),j=l(87648),y=l(55200);function w(e){let{open:t,setOpen:l,missingEnvs:i}=e;return(0,n.jsx)("div",{className:(0,p.cn)("absolute inset-0",!t&&"pointer-events-none"),children:(0,n.jsxs)(y.lG,{open:t,modal:!1,onOpenChange:l,children:[(0,n.jsx)("div",{"data-state":t?"open":"closed",className:(0,p.cn)("bg-alpha-700 dark:bg-alpha-900 absolute inset-0 z-50 transition-opacity data-[state=closed]:pointer-events-none data-[state=closed]:opacity-0 data-[state=open]:opacity-100"),onClick:()=>{t&&l(!1)}}),(0,n.jsxs)(y.Cf,{showClose:!1,onEscapeKeyDown:()=>{var e;return null===(e=document.getElementById("env-warning-trigger"))||void 0===e?void 0:e.focus()},className:"max-h-[400px] max-w-[min(440px,90vw)] gap-2.5 overflow-y-scroll p-3 shadow-sm",omitPortal:!0,onInteractOutside:e=>e.preventDefault(),children:[(0,n.jsxs)(y.HM,{onKeyDown:e=>{"Tab"===e.key&&(e.preventDefault(),document.activeElement instanceof HTMLElement&&document.activeElement.blur())},tabIndex:1,className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:pointer-events-none",children:[(0,n.jsx)(d.F,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,n.jsxs)(y.c7,{className:"items-start text-start",children:[(0,n.jsxs)(y.L3,{className:"flex items-center gap-2 text-lg",children:[(0,n.jsx)(j.o,{className:"!text-amber-600"}),(0,n.jsx)("span",{children:"Missing Environment Variables"})]}),(0,n.jsx)(y.rr,{className:"text-foreground text-sm",children:"This generation may have limited functionality without the following environment variables:"})]}),i.map(e=>(0,n.jsx)("p",{className:"w-fit max-w-full truncate rounded-sm bg-gray-200 px-[3px] py-0.5 font-mono text-[13px] leading-none",children:e},e))]})]})})}var k=l(68971);function N(e,t){e.postMessage({__v0_remote__:1,...t},"*")}function P(e){let{iframeId:t,blockId:l,devTools:y,allowMobileFullscreen:P,isV3:C,children:S}=e,R=(0,m.k)("previewBlock"),{fullScreenResult:T,setFullscreenResult:U}=(0,f.S)(),I=(0,g.$)(),[L,A]=(0,i.useState)(!1),[M,_]=(0,i.useState)(new Map),O=(0,i.useMemo)(()=>{var e;return null!==(e=M.get(t))&&void 0!==e?e:[]},[t,M]),[D,z]=(0,i.useState)(!0),F=(0,i.useMemo)(()=>D&&O.length>0,[D,O]),{canGoBack:V,canGoForward:H,href:B,setHref:W,iframe:Z,latestHref:G,loading:$,setLoading:K,refresh:Q,temporalHref:X,setTemporalHref:Y}=(0,k.Z)(l),q=(0,i.useMemo)(()=>{if(!B)return"";let e=new URL(B);return e.pathname+e.search+e.hash},[B]),J=(0,u.F)(X);(0,i.useEffect)(()=>{if(!Z)return;let e=e=>{let{data:l}=e;if(l&&"object"==typeof l&&l.__v0_remote__&&"missing-envs"===l.type){let e=Array.isArray(l.names)&&l.names.every(e=>"string"==typeof e);_(new Map(M.set(t,e?l.names:[]))),z(l.show)}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[Z,t,M]);let ee=(0,i.useCallback)(()=>{Z&&window.open(G.current||Z.src,"_blank","noreferrer,noopener")},[Z,G]),et=(0,i.useCallback)(()=>{Z&&Z.contentWindow&&(N(Z.contentWindow,{type:"navigate_back"}),Y(null))},[Z]),el=(0,i.useCallback)(()=>{Z&&Z.contentWindow&&(N(Z.contentWindow,{type:"navigate_forward"}),Y(null))},[Z]),en=(0,i.useCallback)(()=>{var e;Z&&Z.contentWindow&&(N(Z.contentWindow,{type:"navigate_to",href:null===J.current?G.current:new URL(null!==(e=J.current)&&void 0!==e?e:"",G.current).href}),K(!0))},[Z,G,J]);return(0,n.jsxs)("div",{className:"flex h-full w-full flex-col","data-slot":"browser",children:[(0,n.jsxs)(x.o,{className:C?"h-6 gap-1 px-0":"bg-muted gap-1 px-2",bottomBorder:!C,children:[(0,n.jsx)(v.Z,{disabled:!V,onClick:et,children:(0,n.jsx)(s.J,{})}),(0,n.jsx)(v.Z,{disabled:!H,onClick:el,children:(0,n.jsx)(a.c,{})}),(0,n.jsx)(v.Z,{onClick:Q,children:$?(0,n.jsx)(E,{}):(0,n.jsx)(c.g,{})}),(0,n.jsxs)("div",{className:"relative mx-1 flex-1",children:[(0,n.jsx)("input",{type:"text",className:(0,p.cn)("focus:border-alpha-200 h-6 w-full min-w-0 rounded-full border border-transparent bg-gray-200 px-2.5 text-gray-900 outline-none hover:bg-gray-300/50",T&&"pl-7"),value:null!==X?X:q,onKeyDown:e=>{"Enter"===e.key?(en(),W(new URL(null!=X?X:"",B).href),Y(null),e.stopPropagation(),e.currentTarget.blur()):"Escape"===e.key&&(Y(null),e.stopPropagation(),e.currentTarget.blur())},onChange:e=>void Y(e.currentTarget.value),onFocus:e=>{e.currentTarget.select()}}),T&&(0,n.jsx)("div",{className:"absolute left-2 top-1/2 -translate-y-1/2",children:(0,n.jsx)(b.o,{className:"size-4"})})]}),O.length>0&&(0,n.jsx)(v.Z,{className:"text-amber-600",id:"env-warning-trigger",tooltipDirection:"bottom",tooltip:"Missing Environment Variables",onClick:()=>z(!F),children:(0,n.jsx)(j.o,{})}),y&&!C?(0,n.jsx)(v.Z,{"data-slot":"button-select",className:(0,p.cn)(L?"!bg-blue-500/15 text-blue-500":"focus:bg-transparent"),tooltip:{side:"bottom",content:"Select"},onClick:()=>{A(e=>!e);let e=document.getElementById(t);e&&e.contentWindow&&N(e.contentWindow,{type:"devtools_enable"})},children:(0,n.jsx)(o.f,{})}):null,(0,n.jsx)(v.Z,{"data-slot":"button-new-tab",tooltip:{side:"bottom",content:(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("span",{children:"Open in new tab"}),(0,n.jsx)("span",{className:"max-w-[200px] text-center text-sm text-gray-400",children:"This link is insecure and can expose your code and data."})]})},onClick:ee,children:(0,n.jsx)(h.H,{})}),(0,n.jsx)(v.Z,{className:(0,p.cn)(!P&&I?"hidden":null),"data-slot":"button-fullscreen","data-testid":"fullscreen-button",tooltip:{side:"bottom",content:R(T?"close":"fullscreen")},onClick:()=>U(!T),children:T?(0,n.jsx)(d.F,{}):(0,n.jsx)(r.g,{})})]}),(0,n.jsxs)("div",{className:"relative flex w-full flex-1 shrink-0 flex-col","data-slot":"browser-content",children:[(0,n.jsx)(w,{open:F,setOpen:z,missingEnvs:O}),S]})]})}function E(){return(0,n.jsx)("svg",{className:"browserframe-loading-spinner",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("circle",{fill:"none",stroke:"currentColor",strokeWidth:"6",strokeLinecap:"round",cx:"33",cy:"33",r:"30"})})}},90923:(e,t,l)=>{"use strict";l.d(t,{o:()=>w,z:()=>k});var n=l(7336),i=l(84274),s=l(81616),a=l(80644),r=l(19895),o=l(67952),c=l(2115),d=l(15993),u=l(88551),m=l(79822),f=l(51621),p=l(97210),h=l(95110),x=l(55556),v=l(97629),g=l(49388),b=l(55655),j=l(77055),y=l(4495);function w(e){var t;let{mergedFromBlockId:l,hasUnsavedChanges:u,overrideBlockId:h,resetValue:x,onSave:j,clearEditValueMap:w,isV3:k}=e,[N,P]=(0,a.useState)(!1),[E,C]=(0,a.useState)(!1),S=(0,r.eu)(),R=(0,o.k)("codeBlockActions"),T=(0,b.r)();(0,g.ML)("code-editor-saved",async()=>{u&&await j({setSaving:P,setForceHide:C})}),t=u,(0,a.useEffect)(()=>{let e=e=>{t&&(e.preventDefault(),e.returnValue="")};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[t]);let U=null!=l?l:(null==S?void 0:S.id)||h;return U?(0,n.jsx)(m.N,{children:u&&!E?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeOut"},className:"from-muted pointer-events-none absolute inset-x-0 bottom-0 z-10 flex h-36 items-end justify-center bg-gradient-to-t to-transparent"},"unsaved-changes-bg"),(0,n.jsx)(f.P.div,{initial:{opacity:0,y:20,scale:.95,width:320},animate:{opacity:1,y:0,scale:1,width:N?96:320},exit:{opacity:0},transition:{duration:.15,ease:"easeOut",width:{type:"spring",stiffness:300,damping:30}},className:(0,y.cn)("shadow-modal bg-background absolute inset-x-0 z-50 mx-auto flex h-11 items-center justify-between rounded-full p-2 pl-3 text-sm font-medium",k?"bottom-16":"bottom-3"),children:N?(0,n.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,n.jsx)(p.y,{size:16}),"Saving"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(i.N,{className:"!text-gray-500"}),"Unsaved Changes"]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(s.$,{size:"sm",className:"h-7",rounded:!0,variant:"secondary",disabled:N,onClick:()=>{(0,c.u)("ResetUnsavedEditCode",{blockId:U}),P(!0);try{x(),d.oR.success(R("resetChanges"),{position:"bottom-right"}),setTimeout(()=>C(!1),2e3),w()}catch(e){d.oR.error(R("failedToResetChanges"),{position:"bottom-right"})}P(!1)},children:R("reset")}),(0,n.jsx)(s.$,{tooltip:{content:(0,n.jsxs)(v.r,{children:[(0,n.jsx)(v.u,{children:T?"⌘":"Ctrl"}),(0,n.jsx)(v.u,{children:"S"})]})},size:"sm",className:"h-7",rounded:!0,disabled:N,onClick:()=>j({setSaving:P,setForceHide:C}),children:R("save")})]})]})},"unsaved-changes-island")]}):null}):null}function k(e){let{blockId:t,editValueMap:l,source:n,meta:i,files:s,clearEditValueMap:m,isAdminSaving:f}=e,p=(0,o.k)("codeBlockActions"),v=(0,r.eu)(),g=(0,r.y6)(),{updateBlockData:b}=(0,h.P6)({blockId:t});return{onSave:async e=>{let{setSaving:s,setForceHide:a}=e;if((0,c.u)("SaveEditCode",{blockId:t}),f&&!window.confirm("[V0 ADMIN] Are you sure you want to save these changes to the user's block?"))return;let r=Object.entries(l||{});if(null==v?void 0:v.templateCanonId)return d.oR.error("Cannot edit a published generation",{position:"bottom-right"});if(!l||r.length<1||!r.some(e=>{let[t,l]=e;return!!l}))return d.oR.error(p("failedToSaveChanges"),{position:"bottom-right"});let o=r[0][1]||n;if("code-project"===i.type){let e=(0,x.A2)({source:n,blockType:"code-project",blockId:t});for(let t of e){let e=l[t.meta.file||""];e&&(t.source=e)}o=(0,x.L5)({files:e,blockType:"code-project"})}s(!0);let m=await (0,j.Z)({blockId:t,source:o});s(!1),m.success?(v&&t===v.id&&g({...v,hasSourceBeenEdited:!0,source:o}),b({blockId:t,data:{hasSourceBeenEdited:!0,source:o}}),a(!0),setTimeout(()=>a(!1),2e3),d.oR.success(p("savedChanges"),{position:"bottom-right"})):(0,u.z)(m)||d.oR.error(p("failedToSaveChanges"))},hasUnsavedChanges:(0,a.useMemo)(()=>{let e=!1;if(!l)return!1;for(let t of s){let n=l[t.meta.file||""];if(n&&n.trimEnd()!==t.source.trimEnd()){e=!0;break}}return e},[l,s]),clearEditValueMap:m}}},92734:(e,t,l)=>{"use strict";l.d(t,{YZ:()=>v,Zf:()=>b,je:()=>g});var n=l(7336),i=l(80644),s=l(74897),a=l(51621),r=l(86410),o=l(79822),c=l(4495),d=l(20287);let u=(0,i.createContext)(void 0),m=()=>{let e=(0,i.useContext)(u);if(void 0===e)throw Error("useResizableContext must be used within a FileTreeProvider");return e};function f(e){let{className:t,...l}=e,{leftId:i,rightId:a,groupId:r,panelGroupRef:o}=m();return(0,n.jsxs)(s.TW,{onDragging:()=>{var e,t,l,n;let c=null===(e=s.PV(i))||void 0===e?void 0:e.offsetWidth,d=null===(t=s.PV(a))||void 0===t?void 0:t.offsetWidth,u=null===(l=s.Gx(r))||void 0===l?void 0:l.offsetWidth;c&&d&&u&&(null===(n=o.current)||void 0===n||n.setLayout([c/u*100,d/u*100]))},className:(0,c.cn)("group relative z-20 w-0 !overflow-visible !outline-none !ring-0",t),...l,children:[(0,n.jsx)("div",{className:"absolute inset-0 h-full w-3 translate-x-[-50%] !outline-0 !ring-0"}),(0,n.jsx)("div",{className:"absolute inset-0 h-full w-0 translate-x-[-50%] !outline-0 !ring-0 transition-all duration-200 group-data-[resize-handle-active=keyboard]:w-[3px] group-data-[resize-handle-state=drag]:w-[3px] group-data-[resize-handle-state=hover]:w-[3px] group-data-[resize-handle-active=keyboard]:bg-gray-400 group-data-[resize-handle-state=drag]:bg-gray-400 group-data-[resize-handle-state=hover]:bg-gray-300 group-data-[resize-handle-active=keyboard]:outline-none"})]})}let p=(0,i.forwardRef)((e,t)=>((0,i.useEffect)(()=>{let l=document.getElementById(e.id);l&&t&&("function"==typeof t?t(l):t.current=l)},[e.id,t]),(0,n.jsx)(s.Zk,{...e})));p.displayName="ForwardPanel";let h=a.P.create(p);function x(e){let t=s.PV(e);if(!t)return 100;let l=parseFloat(getComputedStyle(t).minWidth);return isNaN(l)?100:l}function v(e){let{isFallbackSize:t,collapseSide:l,leftId:a,rightId:r,defaultSizeRef:o,cookie:c,id:m,...f}=e,p=(0,i.useRef)(null),h=(0,i.useRef)(!1);return(0,n.jsx)(u.Provider,{value:{leftId:a,rightId:r,panelGroupRef:p,groupId:m},children:(0,n.jsx)(s.YZ,{id:m,ref:p,onLayout:e=>{var n,i;if(e.length<2)return;let[u,f]=e;if(h.current)return h.current=!1;if(!f||!u)return;let v="right"===l?f:u;o.current=v,t||d.A.set(c,v.toString(),{expires:30});let g=s.PV(a),b=s.PV(r),j=s.Gx(m);if(!g||!b||!j)return;let y=x("right"===l?r:a),w=x("right"===l?a:r);if(v/100*j.offsetWidth<y){let e=y/j.offsetWidth*100;h.current=!0,null===(n=p.current)||void 0===n||n.setLayout("right"===l?[100-e,e]:[e,100-e])}else if(("right"===l?u:f)/100*j.offsetWidth<w){let e=w/j.offsetWidth*100;h.current=!0,null===(i=p.current)||void 0===i||i.setLayout("right"===l?[e,100-e]:[100-e,e])}},...f})})}function g(e){let{collapseSide:t,isOpen:l,order:i,defaultSize:d,className:u,handleTestId:m,collapseId:p,children:x}=e,v=(0,r.d)(0),g=(0,r.d)(1);return(0,n.jsx)(o.N,{initial:!1,mode:"wait",children:l?(0,n.jsxs)(n.Fragment,{children:["right"===t?(0,n.jsx)(f,{"data-testid":m,className:"sticky top-0"},"resize-handle"):null,(0,n.jsx)(h,{transition:{duration:0},variants:{hidden:{flex:"0 1 0px",minWidth:0,overflow:"visible",transition:{when:"beforeChildren",duration:0}}},exit:"hidden",id:p,order:i,defaultSize:d,style:{overflow:"clip"},className:(0,c.cn)("relative",u),children:(0,n.jsx)(a.P.div,{style:{x:v,opacity:g,willChange:"auto"},variants:{initial:{width:"100%",display:"absolute",opacity:0,x:"right"===t?"100%":"-100%"},visible:()=>({width:["100%","100%"],opacity:[g.get(),1],display:["absolute","block"],x:[v.get(),0],transition:{type:"spring",damping:60,stiffness:1100}}),hidden:()=>{var e,l;return{width:null!==(l=null===(e=s.PV(p))||void 0===e?void 0:e.offsetWidth)&&void 0!==l?l:0,display:"absolute",opacity:0,x:"right"===t?"100%":"-100%",transition:{type:"spring",damping:60,stiffness:800}}}},initial:"initial",animate:"visible",exit:"hidden",className:(0,c.cn)("border-alpha-200 absolute inset-y-0 right-0 h-full w-full ","right"===t?"right-0 border-l":"left-0 border-r"),children:x})},"right-panel"),"left"===t?(0,n.jsx)(f,{"data-testid":m,className:"sticky top-0"},"resize-handle"):null]}):(0,n.jsx)(s.Zk,{order:i,defaultSize:0},"zero-panel")})}function b(e){let{initialSize:t,fallbackSize:l=50}=e,[n,s]=(0,i.useState)("number"==typeof t?t:l),a=(0,i.useRef)(n),r=(0,i.useRef)(!0),[o,c]=(0,i.useState)("number"!=typeof t);return(0,i.useEffect)(()=>{"number"!=typeof t&&t.then(e=>{s(e),c(!1),r.current&&(a.current=e,r.current=!1)})},[t]),{initialSize:n,defaultSizeRef:a,isFallbackSize:o}}},93642:(e,t,l)=>{"use strict";l.d(t,{JS:()=>r,Yv:()=>o,wb:()=>a});var n=l(7336),i=l(4495),s=l(95057);function a(e){let{tabs:t,activeTabKey:l,setActiveTabKey:i,disableOverflow:s=!1,isLoading:a}=e;return(0,n.jsxs)("div",{className:"relative flex w-fit min-w-0 flex-1 items-center gap-2 overflow-x-auto",children:[t.map(e=>(0,n.jsx)(c,{active:e.key===l,onClick:()=>i(e.key),disabled:e.disabled,tooltip:e.tooltip,isLoading:a,children:e.display},e.key)),!s&&(0,n.jsx)("div",{className:"from-muted pointer-events-none sticky -right-2 z-10 h-full min-w-8 bg-gradient-to-l via-80% bg-blend-lighten",style:{backgroundImage:"linear-gradient(to left, var(--tw-gradient-stops))"}})]})}function r(e){let{className:t,tabFiles:l,activeTabKey:s}=e;return(0,n.jsx)("div",{className:(0,i.cn)("relative size-full min-h-0 flex-1",t),children:l.map(e=>(0,n.jsx)("div",{className:(0,i.cn)("size-full",s===e.key?"block":"invisible h-0 overflow-hidden"),children:e.content},e.key))})}function o(e){let{tabFiles:t,activeTabKey:l,className:s,setActiveTabKey:o,isLoading:c}=e,d=t.find(e=>e.key===l),u=d?(0,n.jsx)("div",{className:"flex h-full items-center justify-end gap-1",children:d.actions}):null;return(0,n.jsxs)("div",{className:(0,i.cn)("bg-muted flex size-full flex-col",s),children:[(0,n.jsxs)("div",{className:"border-alpha-200 relative flex justify-between border-y p-2",children:[(0,n.jsx)(a,{tabs:t,activeTabKey:null==d?void 0:d.key,setActiveTabKey:o,isLoading:c}),u]}),(0,n.jsx)(r,{tabFiles:t,activeTabKey:null==d?void 0:d.key})]})}function c(e){let{active:t,children:l,disabled:a,onClick:r,tooltip:o,isLoading:c}=e,d=(0,n.jsx)("button",{className:(0,i.cn)("font-regular group h-7 max-w-56 select-none whitespace-nowrap rounded-md px-2 text-sm font-medium transition-all",t?"bg-alpha-200 text-gray-900":"hover:bg-alpha-200 bg-transparent text-gray-500",a&&!t&&"cursor-not-allowed hover:bg-transparent"),onClick:r,disabled:a,"data-testid":"tab-file-button","data-active-tab":t,children:(0,n.jsx)("div",{className:"truncate",children:l})});return o||a?(0,n.jsx)(s.Tooltip,{side:"bottom",className:"max-w-[250px] text-wrap text-center",content:o||(c?"Preview is loading":"Preview is disabled"),children:d}):d}}}]);